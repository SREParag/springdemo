/* sabre-spark - v2.2.0 - 2017-4-25 DO NOT MODIFY THIS FILE DIRECTLY OR YOU WILL NOT BE ABLE TO UPDATE YOUR VERSION OF SPARK. */
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,(t.Spark||(t.Spark={})).Toolbar=e()}}(function(){return function e(t,o,i){function r(n,l){if(!o[n]){if(!t[n]){var a="function"==typeof require&&require;if(!l&&a)return a(n,!0);if(s)return s(n,!0);var d=new Error("Cannot find module '"+n+"'");throw d.code="MODULE_NOT_FOUND",d}var u=o[n]={exports:{}};t[n][0].call(u.exports,function(e){var o=t[n][1][e];return r(o||e)},u,u.exports,e,t,o,i)}return o[n].exports}for(var s="function"==typeof require&&require,n=0;n<i.length;n++)r(i[n]);return r}({1:[function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(o,"__esModule",{value:!0});var s=e("../helpers/util/debounce"),n=i(s),l=e("../helpers/dom/add-class"),a=i(l),d=e("../helpers/dom/has-class"),u=i(d),h=e("../helpers/dom/remove-class"),p=i(h),c=e("../helpers/dom/parse-attribute"),f=function(){function e(t){r(this,e),t&&this._init(t)}return e.prototype.change=function(){this._closeAll(),(0,p.default)(this.el,["ready","show-more","measured"]);for(var e=document.createDocumentFragment(),t=0;t<this.items.length;t++)e.appendChild(this.items[t].el);return this.visibleContainer.appendChild(e),this._initItems(),(0,a.default)(this.el,"measured"),this._calculateStyles(),(0,a.default)(this.el,"ready"),this},e.prototype.update=function(e){return e?(this.remove(!0),this._init(e)):this.change(),this},e.prototype.remove=function(e){this._removeListeners(),delete this.el.sparktoolbarcon,delete this.showMoreButton.sparktoolbarshowmore;for(var t=0;t<this.items.length;t++)this.items[t].remove();return!e&&this.el.parentNode&&(this.el.parentNode.removeChild(this.el),this.el=void 0),this},e.prototype.toolbarItem=function(e,t,o){var i={};return i.parent=e,i.el=t,i.priority=i.el.attributes["data-priority"]?i.el.attributes["data-priority"].value:0,i.order=i.el.attributes["data-order"]?i.el.attributes["data-order"].value:o,i.hasContent=!!i.el.querySelector(".spark-toolbar__item--content"),i.helper=i.el.querySelector(".spark-toolbar__item-helper"),i.label=!!i.el.attributes.label&&i.el.attributes.label.value,i.closeOnClick=(0,u.default)(i.el,"spark-toolbar__item--close-more-on-click"),i.width=i.el.offsetWidth,i.height=i.el.offsetHeight,i.dropdown=t.querySelector(".spark-toolbar__item--content"),i.dropdown&&(i.dropdown.sparktoolbardropdown=!0),i.toggleDropdown=function(e){if(void 0!==e?!e:i.toggleDropdown.open)i.toggleDropdown.open=!1,(0,p.default)(i.el,"animate"),window.setTimeout(function(){(0,p.default)(i.el,"open")},100);else if(i.hasContent){i.toggleDropdown.open=!0,(0,a.default)(i.el,"open"),i.positionDropdown();var t=document.createEvent("Event");t.initEvent("spark.visible-children",!0,!0),i.dropdown.dispatchEvent(t),window.setTimeout(function(){(0,a.default)(i.el,"animate")},0)}else i.parent._toggleShowMore(!1)},i.handleClick=function(e){if((0,c.boolean)(i.el,"disabled"))return void e.preventDefault();if(i.toggleDropdown.open)if(e.target===i.el||e.target===i.helper)i.toggleDropdown();else for(var t=e.target;t!==i.el;){if((0,u.default)(t,"spark-toolbar__item--close-on-click")){i.toggleDropdown(!1),i.parent._toggleShowMore(!1);break}t=t.parentElement}else i.toggleDropdown(!0)},i.positionDropdown=function(){if(i.dropdown){i.dropdown.style.left="",i.dropdown.style.right="";var e=i.dropdown.getBoundingClientRect(),t=window.pageXOffset,o=window.pageXOffset+document.documentElement.clientWidth;e.right>o&&(i.dropdown.style.left="inherit",i.dropdown.style.right=0),e.left<t&&(i.dropdown.style.left=0,i.dropdown.style.right="inherit")}},i.remove=function(){i.el&&delete i.el.sparktoolbar,i.dropdown&&delete i.dropdown.sparktoolbardropdown},i.el.sparktoolbar=i,i},e.prototype._closeAll=function(){this._closeItems(),this._toggleShowMore(!1)},e.prototype._getOpenItems=function(){for(var e=[],t=0;t<this.items.length;t++)this.items[t].toggleDropdown.open&&e.push(this.items[t]);return e},e.prototype._closeItems=function(e){e=void 0===e?this._getOpenItems():e;for(var t=0;t<e.length;t++)e[t].toggleDropdown(!1)},e.prototype._init=function(e){this.el=e,this.el.sparktoolbarcon=this,this.visibleContainer=this.el.querySelector(".spark-toolbar__container--visible"),this.hiddenContainer=this.el.querySelector(".spark-toolbar__container--hidden"),this.showMoreButton=this.el.querySelector(".spark-toolbar__show-more"),this.showMoreButton.sparktoolbarshowmore=!0,this.isOpen=!1,this.isFocus=!1,this._setupListeners(),this.el.style.width="100%",this._initItems(),(0,a.default)(this.el,"measured"),this._calculateStyles(),this.tabindex=this.el.attributes.tabindex?this.el.attributes.tabindex.value:0,(0,a.default)(this.el,"ready")},e.prototype._initItems=function(){var e=this.el.querySelectorAll(".spark-toolbar__item");this.items=[];for(var t=0;t<e.length;t++)this.items[t]=new this.toolbarItem(this,e[t],t)},e.prototype._setupListeners=function(){this._handleWindowClick=this._handleWindowClickH.bind(this),document.addEventListener("click",this._handleWindowClick),this._handleResize=(0,n.default)(this._handleResizeH.bind(this),100),window.addEventListener("resize",this._handleResize),this._handleKeyDown=this._handleKeyDownH.bind(this),this.el.addEventListener("keydown",this._handleKeyDown),this._handleFocus=this._handleFocusH.bind(this),document.addEventListener("focus",this._handleFocus,!0),this._handleBlur=this._handleBlurH.bind(this),document.addEventListener("blur",this._handleBlur,!0),this._handleVisibleChildren=this._handleVisibleChildrenH.bind(this),document.addEventListener("spark.visible-children",this._handleVisibleChildren,!0)},e.prototype._removeListeners=function(){document.removeEventListener("click",this._handleWindowClick),window.removeEventListener("resize",this._handleResize),this.el.removeEventListener("keydown",this._handleKeyDown),document.removeEventListener("blur",this._handleBlur,!0),document.removeEventListener("focus",this._handleFocus,!0),document.removeEventListener("spark.visible-children",this._handleVisibleChildren,!0)},e.prototype._handleBlurH=function(e){this.el.contains(e.target)&&(this.el.attributes.tabindex.value=this.tabindex)},e.prototype._handleFocusH=function(e){if(this.el.contains(e.target)){if(this.el.attributes.tabindex.value=-1,e.target.sparktoolbarcon)return void this._focusLast();if(e.target.sparktoolbar)return void e.target.sparktoolbar.el.focus();for(var t=e.target;!t.sparktoolbarcon&&!t.sparktoolbar;){if(t.sparktoolbardropdown)return void(this.el.attributes.tabindex.value=this.tabindex);t=t.parentElement}}else this._closeAll(),this.el.attributes.tabindex.value=this.tabindex},e.prototype._focusLast=function(){if(!this._lastFocus){var e=this.visibleContainer.querySelector(".spark-toolbar__item")||this.hiddenContainer.querySelector(".spark-toolbar__item");this._lastFocus=e.sparktoolbar}this.hiddenContainer.contains(this._lastFocus.el)&&this._toggleShowMore(!0),this._lastFocus.el.focus()},e.prototype._handleKeyDownH=function(e){for(var t=e.target;!t.sparktoolbarcon&&!t.sparktoolbar;){if(t.sparktoolbardropdown)return;t=t.parentElement}if(t.sparktoolbar)switch(e.keyCode){case 37:case 38:t.previousSibling&&t.previousSibling.sparktoolbar?(this._lastFocus=t.previousSibling.sparktoolbar,t.previousSibling.focus()):this.visibleContainer.querySelector(".spark-toolbar__item")!==t.sparktoolbar.el&&(t=this.visibleContainer.querySelector(".spark-toolbar__item:last-of-type"))&&(this._toggleShowMore(!1),this._lastFocus=t.sparktoolbar,t.focus()),this._closeItems(),e.preventDefault();break;case 39:case 40:t.nextSibling&&t.nextSibling.sparktoolbar?(this._lastFocus=t.nextSibling.sparktoolbar,t.nextSibling.focus()):this.hiddenContainer.querySelector(".spark-toolbar__item:last-of-type")!==t.sparktoolbar.el&&(t=this.hiddenContainer.querySelector(".spark-toolbar__item"))&&(this._toggleShowMore(!0),this._lastFocus=t.sparktoolbar,t.focus()),this._closeItems(),e.preventDefault();break;case 32:e.preventDefault(),e.target.sparktoolbar&&e.target.sparktoolbar.el.click();break;case 13:e.target.sparktoolbar&&e.target.sparktoolbar.el.click()}},e.prototype._handleVisibleChildrenH=function(e){e.target.contains(this.el)&&window.setTimeout(function(){this.change()}.bind(this),0)},e.prototype._handleWindowClickH=function(e){if((0,c.boolean)(e.target,"disabled"))return void e.preventDefault();if(this.el.contains(e.target)){var t=e.target;if(t===this.visibleContainer||t===this.el)return e.stopPropagation(),void e.preventDefault();for(;t!==this.el;){if(t.sparktoolbar){var o=this._getOpenItems();return o.indexOf(t.sparktoolbar)>=0&&o.splice(o.indexOf(t.sparktoolbar),1),this._closeItems(o),this.hiddenContainer.contains(e.target)||this._toggleShowMore(!1),t.sparktoolbar.handleClick(e)}if(t.sparktoolbarshowmore)return this._closeItems(),void this._toggleShowMore();t=t.parentElement}this._closeAll()}else this._closeItems(),this._toggleShowMore(!1)},e.prototype._toggleShowMore=function(e){(void 0!==e?!e:this.isOpen)?((0,p.default)(this.el,"animate"),window.setTimeout(function(){(0,p.default)(this.el,"open"),this.isOpen=!1}.bind(this),100)):(this.isOpen=!0,(0,a.default)(this.el,"open"),this._positionShowMore(),window.setTimeout(function(){(0,a.default)(this.el,"animate")}.bind(this),0))},e.prototype._positionShowMore=function(){this.hiddenContainer.style.right="0px";var e=this.hiddenContainer.getBoundingClientRect(),t=window.pageXOffset,o=window.pageXOffset+document.documentElement.clientWidth;e.right>o&&(this.hiddenContainer.style.right="calc("+(e.right-o)+"px + 1rem)"),e.left<t&&(this.hiddenContainer.style.right="calc("+(e.left-t)+"px - 1rem)")},e.prototype._handleResizeH=function(){this._closeAll(),this._calculateStyles()},e.prototype._calculateStyles=function(e){this.el.style.width="100%",(e=void 0!==e&&e)||(0,p.default)(this.el,"show-more");var t,o=[],i=[];this.items.sort(this._prioritySort);var r=this.visibleContainer.clientWidth;for(t=0;t<this.items.length;t++)if(r-this.items[t].width>=0)o.push(this.items[t]),r-=this.items[t].width;else{if(!e)return(0,a.default)(this.el,"show-more"),this._calculateStyles(!0);i.push(this.items[t])}o.sort(this._orderSort),i.sort(this._orderSort);var s=document.createDocumentFragment(),n=document.createDocumentFragment();for(t=0;t<o.length;t++)s.appendChild(o[t].el);for(t=0;t<i.length;t++)n.appendChild(i[t].el);this.visibleContainer.appendChild(s),this.hiddenContainer.appendChild(n),this.el.style.width=""},e.prototype._prioritySort=function(e,t){return t.priority-e.priority},e.prototype._orderSort=function(e,t){return e.order-t.order},e}();o.default=f,t.exports=o.default},{"../helpers/dom/add-class":2,"../helpers/dom/has-class":3,"../helpers/dom/parse-attribute":4,"../helpers/dom/remove-class":5,"../helpers/util/debounce":6}],2:[function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(t=2===arguments.length&&"string"==typeof t?(0,n.default)(t).split(d):t instanceof Array?t:Array.prototype.slice.call(arguments,1),1===t.length&&e.classList)return t[0]&&e.classList.add(t[0]),e;for(var o=[],i=0,r=t.length,s=void 0,l="string"==typeof e.className?e.className:e.getAttribute?e.getAttribute("class"):"";i<r;i++)(s=t[i])&&!(0,a.default)(l,s)&&o.push(s);return o.length&&("string"==typeof e.className?e.className=(0,n.default)((l+" "+o.join(" ")).replace(u," ")):e.setAttribute&&e.setAttribute("class",(0,n.default)((l+" "+o.join(" ")).replace(u," ")))),e}Object.defineProperty(o,"__esModule",{value:!0});var s=e("../util/trim"),n=i(s),l=e("./has-class"),a=i(l),d=/\s+/,u=/\s{2,}/g;o.default=r,t.exports=o.default},{"../util/trim":7,"./has-class":3}],3:[function(e,t,o){"use strict";function i(e,t){return-1!==(" "+("object"===(void 0===e?"undefined":r(e))?e.className||e.getAttribute&&e.getAttribute("class")||"":e||"").replace(/[\t\r\n\f]/g," ")+" ").indexOf(" "+t+" ")}Object.defineProperty(o,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};o.default=i,t.exports=o.default},{}],4:[function(e,t,o){"use strict";function i(e,t,o){var i=e.getAttribute(t);return null===i?o:"true"===i||""===i}function r(e,t,o){var i=e.getAttribute(t);return null===i?o:parseInt(i,10)}function s(e,t,o){var i=e.getAttribute(t);return null===i?o:i}Object.defineProperty(o,"__esModule",{value:!0}),o.boolean=i,o.number=r,o.string=s},{}],5:[function(e,t,o){"use strict";function i(e,t){if(t=2===arguments.length&&"string"==typeof t?(0,s.default)(t).split(n):t instanceof Array?t:Array.prototype.slice.call(arguments,1),1===t.length&&e.classList)return t[0]&&e.classList.remove(t[0]),e;for(var o=" "+("string"==typeof e.className?e.className:e.getAttribute?e.getAttribute("class"):"")+" ",i=o,r=void 0,a=void 0,d=0,u=t.length;d<u;d++)r=t[d],-1!==(a=r?i.indexOf(" "+r+" "):-1)&&(a+=1,i=i.slice(0,a)+i.slice(a+r.length));return o!==i&&("string"==typeof e.className?e.className=(0,s.default)(i.replace(l," ")):e.setAttribute&&e.setAttribute("class",(0,s.default)(i.replace(l," ")))),e}Object.defineProperty(o,"__esModule",{value:!0});var r=e("../util/trim"),s=function(e){return e&&e.__esModule?e:{default:e}}(r),n=/\s+/,l=/\s{2,}/g;o.default=i,t.exports=o.default},{"../util/trim":7}],6:[function(e,t,o){"use strict";function i(e,t){var o=void 0;return function(){var i=arguments;o&&window.clearTimeout(o),o=window.setTimeout(function(){e.apply(this,i)},t)}}Object.defineProperty(o,"__esModule",{value:!0}),o.default=i,t.exports=o.default},{}],7:[function(e,t,o){"use strict";function i(e){return e.replace(r,"")}Object.defineProperty(o,"__esModule",{value:!0});var r=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;o.default=i,t.exports=o.default},{}]},{},[1])(1)});