{"version":3,"sources":["js/dist/components/node_modules/browser-pack/_prelude.js","js/dist/components/js/dist/components/base.js","js/dist/components/js/dist/components/carousel.js","js/dist/components/js/dist/helpers/css/transform.js","js/dist/components/js/dist/helpers/dom/add-class.js","js/dist/components/js/dist/helpers/dom/has-class.js","js/dist/components/js/dist/helpers/dom/remove-class.js","js/dist/components/js/dist/helpers/util/debounce.js","js/dist/components/js/dist/helpers/util/each.js","js/dist/components/js/dist/helpers/util/trim.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9pCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"carousel.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _each = require('../helpers/util/each');\n\nvar _each2 = _interopRequireDefault(_each);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } } /**\n                                                                                                                                                           * # Base Component\n                                                                                                                                                           * The base class for Spark JS components. This class should never be\n                                                                                                                                                           * instantiated directly.\n                                                                                                                                                           *\n                                                                                                                                                           * @param {Element} el\n                                                                                                                                                           * @param {Object} params\n                                                                                                                                                           *\n                                                                                                                                                           * @module components/base.js\n                                                                                                                                                           */\n\nvar noop = function noop() {};\n\nvar Base = function () {\n\n  /**\n   * Set parameters and cache elements.\n   */\n  function Base(el) {\n    var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, Base);\n\n    if (params.elRequired && !el) {\n      return;\n    }\n\n    this.setParams(this.defaults || {}, true);\n    this.setParams(params);\n    (this._cacheElements || noop).call(this, el, params);\n    (this._parseParams || noop).call(this);\n  }\n\n  /**\n   * Remove the component from the DOM and prepare for garbage collection by dereferencing values.\n   * @param {Boolean} leaveElement Leave the element intact.\n   */\n\n\n  Base.prototype.remove = function remove(leaveElement) {\n\n    if (this._removeEventListeners) {\n      this._removeEventListeners();\n    }\n\n    if (!leaveElement && this.el && this.el.parentNode) {\n      this.el.parentNode.removeChild(this.el);\n    }\n\n    this.unsetParams(this.defaults);\n\n    return this;\n  };\n\n  /**\n   * Update the component to use a new element or reparse from\n   * the existing element.\n   * @param {Element} el Optional\n   * @param {Object} params Optional\n   */\n\n\n  Base.prototype.update = function update(el) {\n    var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n\n    if (this._removeEventListeners) {\n      this._removeEventListeners();\n    }\n\n    (this._cacheElements || noop).call(this, el || this.el, params);\n    (this._parseParams || noop).call(this);\n\n    if (this._addEventListeners) {\n      this._addEventListeners();\n    }\n\n    return this;\n  };\n\n  /**\n   * Set a hash of parameters if they're whitelisted or we're told to force the set.\n   * This is used to set initial values as well as set passed parameters.\n   * @param {Object} params\n   * @param {Boolean} force Force setting even if the param is not whitelisted.\n   */\n\n\n  Base.prototype.setParams = function setParams(params, force) {\n    var _this = this;\n\n    (0, _each2.default)(params, function (k, v) {\n      if (_this._whitelistedParams.indexOf(k) !== -1 || force) {\n        _this[k] = v;\n      }\n    });\n\n    return this;\n  };\n\n  /**\n   * Unset all parameters.\n   * @param {Array|Object} keys\n   * @param {Object} scope The object to unset the params from. Defaults to `this`.\n   */\n\n\n  Base.prototype.unsetParams = function unsetParams(keys, scope) {\n\n    keys = keys instanceof Array ? keys : Object.keys(keys);\n    scope = scope || this;\n    (0, _each2.default)(keys, function (k) {\n      delete scope[k];\n    });\n\n    return this;\n  };\n\n  return Base;\n}();\n\n/**\n * Whitelisted parameters which can be set on construction.\n * @type {Array}\n */\n\n\nBase.prototype._whitelistedParams = [];\n\n/**\n * Default values for internal properties we will be setting.\n * These are set on each construction so we don't leak properties\n * into the prototype chain.\n * @type {Object}\n */\nBase.prototype.defaults = {};\n\nexports.default = Base;\nmodule.exports = exports['default'];\n//# sourceMappingURL=base.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _base = require('./base');\n\nvar _base2 = _interopRequireDefault(_base);\n\nvar _debounce = require('../helpers/util/debounce');\n\nvar _debounce2 = _interopRequireDefault(_debounce);\n\nvar _transform = require('../helpers/css/transform');\n\nvar _transform2 = _interopRequireDefault(_transform);\n\nvar _addClass = require('../helpers/dom/add-class');\n\nvar _addClass2 = _interopRequireDefault(_addClass);\n\nvar _removeClass = require('../helpers/dom/remove-class');\n\nvar _removeClass2 = _interopRequireDefault(_removeClass);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * # Carousel\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Create a Carousel\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @example\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * new Carousel(el);\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @module components/carousel.js\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\nvar Carousel = function (_BaseComponent) {\n  _inherits(Carousel, _BaseComponent);\n\n  /**\n   * Carousel constructor.\n   * @param {Element} el\n   * @param {Object} params\n   */\n  function Carousel(el, params) {\n    _classCallCheck(this, Carousel);\n\n    var _this = _possibleConstructorReturn(this, _BaseComponent.call(this, el, params));\n\n    params = params || {};\n\n    if (!el) {\n      return _possibleConstructorReturn(_this);\n    }\n\n    _this._init(el);\n    return _this;\n  }\n\n  /**\n   * Carousel Item Contructor, exposes access to functions setTransform, setSelected, and currentPosition\n   * @param {Element} el Node to initalize as carouselItem\n   * @param {Object} parent reference to the parent carousel\n   * @param {Element} dot Node to use as dot element\n   * @param {Number} order original order in the markup\n   */\n\n\n  Carousel.prototype._carouselItem = function _carouselItem(el, parent, dot, order) {\n    var a = {};\n    a.el = el;\n    a.parent = parent;\n    a.dot = dot;\n    a.order = order;\n    a.addTransform = function (x) {\n      a.setTransform(a.transform.x + x);\n    };\n    a.setTransform = function (x) {\n      x = x ? x : 0;\n      a.transform = {\n        'x': x\n      };\n      a.el.setAttribute('style', (0, _transform2.default)('translate3d', a.transform.x + 'px, 0px, 0px'));\n    };\n    a.setSelected = function (b) {\n      if (a.setSelected.selected === b && typeof a.setSelected.selected !== 'undefined') {\n        return;\n      }\n      if (b) {\n        (0, _addClass2.default)(a.el, 'selected');\n        (0, _addClass2.default)(a.dot, 'selected');\n        a.setSelected.selected = true;\n      } else {\n        (0, _removeClass2.default)(a.el, 'selected');\n        (0, _removeClass2.default)(a.dot, 'selected');\n        a.setSelected.selected = false;\n      }\n    };\n    a.currentPosition = function () {\n      return parent.transform.x + a.transform.x + a.dims.left + a.width / 2 - parent.dims.left;\n    };\n    a.setTransform();\n    a.dims = el.getBoundingClientRect();\n    a.width = a.dims.width;\n    a.el.sparkcarouselitem = a;\n    a.dot.sparkcarouselitemdot = a;\n    return a;\n  };\n\n  /**\n   * Scans element and sets up or resets the carousel based on configuration\n   * @param {Element} el Node to initalize as the carousel\n   */\n\n\n  Carousel.prototype._init = function _init(el) {\n    //cache elements and controls\n    this.el = el;\n    this.el.sparkcarousel = this;\n    this.backe = this.el.querySelector('.spark-carousel__back');\n    this.forwarde = this.el.querySelector('.spark-carousel__forward');\n    this.outerContainer = this.el.querySelector('.spark-carousel__outer-container');\n    this.containerMask = this.el.querySelector('.spark-carousel__container-mask');\n    this.container = this.el.querySelector('.spark-carousel__container');\n    this.dots = this.el.querySelector('.spark-carousel__dots');\n    this.pauseEl = this.el.querySelector('.spark-carousel__pause');\n    //get the options from the element\n    this.opts = {};\n    this.opts.wrapItems = this.el.attributes['data-spark-carousel-wrap-items'] ? true : false;\n    this.opts.startingVelocity = this.el.attributes['data-spark-carousel-scroll-velocity'] ? this.el.attributes['data-spark-carousel-scroll-velocity'].value : 10;\n    this.opts.smoothScroll = this.el.attributes['data-spark-carousel-smooth-scroll'] ? true : false;\n    this.opts.smoothScrollCenterItems = this.el.attributes['data-spark-carousel-smooth-scroll-center'] ? true : false;\n    this.opts.panelScroll = this.el.attributes['data-spark-carousel-panel'] ? true : false;\n    this.opts.edgeScroll = this.opts.panelScroll || this.el.attributes['data-spark-carousel-edge'] ? true : false;\n    this.opts.autoAdvance = this.el.attributes['data-spark-carousel-auto-advance'] ? this.el.attributes['data-spark-carousel-auto-advance'].value : false;\n    //setup autoAdvance\n    if (this.opts.autoAdvance && !this.autoAdvance && !this.pause) {\n      this.autoAdvance = window.setTimeout(function () {\n        this._autoAdvance();\n      }.bind(this), this.opts.autoAdvance * 1000);\n    }\n    //conditionally bind pause handlers.\n    //needs to be done here so that resetting the carousel will work correctly\n    if (this.opts.autoAdvance && !this.pauseH) {\n      this.pauseH = this._pause.bind(this);\n      this.pauseEl.addEventListener('click', this.pauseH);\n    }\n    //collect items and cache sizing\n    var a = this.el.querySelectorAll('.spark-carousel__item');\n    this.items = [];\n    this.totalItemWidth = 0;\n    this.dims = this.containerMask.getBoundingClientRect();\n    this.width = this.dims.width;\n    this.height = this.dims.height;\n    var dots = document.createDocumentFragment();\n    var b;\n    //create our carouselItems\n    for (var i = 0; i < a.length; i++) {\n      b = document.createElement('div');\n      dots.appendChild(b);\n      this.items.push(new this._carouselItem(a[i], this, b, i));\n      this.totalItemWidth += this.items[i].width;\n    }\n    //if we're resetting we need to empty out the exisiting elements first\n    while (this.dots.firstChild) {\n      this.dots.removeChild(this.dots.firstChild);\n    }\n    this.dots.appendChild(dots);\n    //this is to test if we're dealing with 2011 flexbox (IE10) and need to do an adjustment\n    //this is because ms-flex-pack: center doesn't work like 2012 flexbox center-pack\n    if (typeof this.container.style.msFlexAlign !== 'undefined') {\n      this._transformItems(-(this.totalItemWidth - this.width) / 2);\n    }\n    //setup inital transform\n    this._setTransform();\n    //need to bind this event handler here as we are always going to need to be listening\n    //for this event, in order to react to container visibility changing\n    this._handleVisibleChildren = this._handleVisibleChildrenH.bind(this);\n    document.addEventListener('spark.visible-children', this._handleVisibleChildren, true);\n    if (!this._rafHandler) {\n      this._rafHandler = this._rafHandlerH.bind(this);\n    }\n    //need to also listen to resize events, even if we don't have items overflowing\n    if (!this.resizeH) {\n      this.resizeH = (0, _debounce2.default)(this._resize.bind(this), 100);\n      window.addEventListener('resize', this.resizeH);\n    }\n    //if we haven't already init'd event listerers, and we have items overflowing\n    if (this.totalItemWidth > this.width) {\n      if (!this.touchstartH) {\n        (0, _removeClass2.default)(this.el, 'noscroll');\n        this._setupListeners();\n        //center the first item\n        this._addTransform(-this.items[0].currentPosition() + this.width / 2);\n      }\n    }\n    //if we don't have overflowing items, then disable scrolling and remove listeners\n    else {\n        (0, _addClass2.default)(this.el, 'noscroll');\n        this._removeListeners();\n      }\n    //set the new selected item\n    this._updateSelected();\n    //finally, display the element\n    (0, _addClass2.default)(this.el, 'ready');\n  };\n\n  /**\n   * Tears down the component, removes listeners, and conditionally delete the DOM element\n   * @param {Boolean} leaveElement Falsey value will remove the DOM element as well as the component instance\n   */\n\n\n  Carousel.prototype.remove = function remove(leaveElement) {\n    window.removeEventListener('resize', this.resizeH);\n    delete this.resizeH;\n    document.removeEventListener('spark.visible-children', this._handleVisibleChildren, true);\n    delete this._handleVisibleChildren;\n    _BaseComponent.prototype.remove.call(this, leaveElement);\n  };\n\n  /**\n   * Pause/unpause the autoAdvance feature\n   */\n\n\n  Carousel.prototype._pause = function _pause() {\n    if (this.pause) {\n      delete this.moves;\n      this.autoAdvance = window.setTimeout(function () {\n        this._autoAdvance();\n      }.bind(this), this.opts.autoAdvance * 1000);\n    } else {\n      this._rafCancel();\n      if (!this.opts.smoothScroll || this.opts.smoothScrollCenterItems) {\n        this._scrollTo(this._selectedItem());\n      }\n      window.clearTimeout(this.autoAdvance);\n      delete this.autoAdvance;\n    }\n    this._setPause(!this.pause);\n  };\n\n  /**\n   * toggles the pause class on the element\n   * @param {Boolean} b Truthy value will give the element the pause class\n   */\n\n\n  Carousel.prototype._setPause = function _setPause(b) {\n    if (typeof b === 'undefined') {\n      this.pause = typeof this.pause === 'undefined' ? false : this.pause;\n      return this.pause;\n    } else {\n      if (b) {\n        (0, _addClass2.default)(this.el, 'pause');\n      } else {\n        (0, _removeClass2.default)(this.el, 'pause');\n      }\n      this.pause = b;\n      return this.pause;\n    }\n  };\n\n  /**\n   * function called by window.setTimeout, will check first to see if element is in use before triggering a slide advance\n   */\n\n\n  Carousel.prototype._autoAdvance = function _autoAdvance() {\n    if (!this.moves && !this._laststart && !this.paused) {\n      this._rafCancel();\n      var a = this.items.indexOf(this._selectedItem());\n      this._scrollToItem = true;\n      this._scrollTo(this.items[a === this.items.length - 1 ? 0 : a + 1]);\n      this.autoAdvance = window.setTimeout(function () {\n        this._autoAdvance();\n      }.bind(this), this.opts.autoAdvance * 1000);\n    }\n  };\n\n  /**\n   * initalize and bind even listeners\n   */\n\n\n  Carousel.prototype._setupListeners = function _setupListeners() {\n    this.touchstartH = this._touchstart.bind(this);\n    this.container.addEventListener('touchstart', this.touchstartH);\n    this.touchmoveH = this._touchmove.bind(this);\n    window.addEventListener('touchmove', this.touchmoveH);\n    this.touchendH = this._touchend.bind(this);\n    window.addEventListener('touchend', this.touchendH);\n    this.mousedownH = this._mousedown.bind(this);\n    this.container.addEventListener('mousedown', this.mousedownH);\n    this.mousemoveH = this._mousemove.bind(this);\n    window.addEventListener('mousemove', this.mousemoveH);\n    this.mouseupH = this._mouseup.bind(this);\n    window.addEventListener('mouseup', this.mouseupH);\n    this.forwardH = this._forward.bind(this);\n    this.forwarde.addEventListener('click', this.forwardH);\n    this.backH = this._back.bind(this);\n    this.backe.addEventListener('click', this.backH);\n    this.clickH = this._click.bind(this);\n    this.el.addEventListener('click', this.clickH);\n    this._focusHandler = this._scrollToClicked.bind(this);\n    this.container.addEventListener('focus', this._focusHandler, true);\n  };\n\n  /**\n   * Removes non-essential event listeners, called when tearing down the component, or our content\n   * does not exceed the width of our element\n   */\n\n\n  Carousel.prototype._removeListeners = function _removeListeners() {\n    this.el.removeEventListener('touchstart', this.touchstartH);\n    delete this.touchstartH;\n    window.removeEventListener('touchmove', this.touchmoveH);\n    delete this.touchmoveH;\n    window.removeEventListener('touchend', this.touchendH);\n    delete this.touchendH;\n    this.el.removeEventListener('mousedown', this.mousedownH);\n    delete this.mousedownH;\n    window.removeEventListener('mousemove', this.mousemoveH);\n    delete this.mousemoveH;\n    window.removeEventListener('mouseup', this.mouseupH);\n    delete this.mouseupH;\n    this.forwarde.removeEventListener('click', this.forwardH);\n    delete this.forwardH;\n    this.backe.removeEventListener('click', this.backH);\n    delete this.backH;\n    this.el.removeEventListener('click', this.clickH);\n    delete this.clickH;\n    this.container.removeEventListener('focus', this._focusHandler, true);\n    delete this._focusHandler;\n    if (this.pauseEl) {\n      this.pauseEl.removeEventListener('click', this.pauseH);\n      delete this.pauseH;\n    }\n  };\n\n  /**\n   * Event handler for the spark.visible-children event, just call the change function to handle any\n   * visibility or sizing changes\n   * @param {Event} e The spark.visible-children event\n   */\n\n\n  Carousel.prototype._handleVisibleChildrenH = function _handleVisibleChildrenH(e) {\n    if (e.target.contains(this.el)) {\n      window.setTimeout(function () {\n        this.change();\n      }.bind(this), 0);\n    }\n  };\n\n  /**\n   * Forward button click handler triggers a scrollTo to the \"next\" element\n   * @param {Event} e The click event\n   */\n\n\n  Carousel.prototype._forward = function _forward(e) {\n    var s = this.items.indexOf(this._selectedItem());\n    s++;\n    if (s > this.items.length - 1) {\n      if (this.opts.wrapItems) {\n        s = 0;\n      } else {\n        s--;\n      }\n    }\n    delete this.moves;\n    var a = this._startingVelocity;\n    a = a < -this.opts.startingVelocity ? a : -this.opts.startingVelocity;\n    this._rafCancel();\n    this._scrollToItem = true;\n    this._scrollTo(this.items[s], a);\n    if (e) {\n      e.preventDefault();\n    }\n  };\n\n  /**\n   * Back button click handler triggers a scrollTo to the \"previous\" element\n   * @param {Event} e The click event\n   */\n\n\n  Carousel.prototype._back = function _back(e) {\n    var s = this.items.indexOf(this._selectedItem());\n    s--;\n    if (s < 0) {\n      if (this.opts.wrapItems) {\n        s = this.items.length - 1;\n      } else {\n        s++;\n      }\n    }\n    delete this.moves;\n    var a = this._startingVelocity;\n    a = a > this.opts.startingVelocity ? a : this.opts.startingVelocity;\n    this._rafCancel();\n    this._scrollToItem = true;\n    this._scrollTo(this.items[s], a);\n    if (e) {\n      e.preventDefault();\n    }\n  };\n\n  /**\n   * Move start handler, handles both touchstart and mousedown events\n   * @param {Object} e The start event\n   */\n\n\n  Carousel.prototype._movestart = function _movestart(e) {\n    this._rafCancel();\n    this.moves = [];\n    this.moves.push(e);\n  };\n\n  /**\n   * Move handler, handles internal move event objects\n   * @param {Object} e The move event\n   */\n\n\n  Carousel.prototype._move = function _move(e) {\n    if (this.moves && this.moves.length > 1) {\n      this._addTransform(e.pageX - this.moves[this.moves.length - 1].pageX);\n      this.moves.push(e);\n      e.preventDefault = true;\n    } else {\n      if (this.moves && this.moves[0]) {\n        if (Math.abs(this.moves[0].pageX - e.pageX) > Math.abs(this.moves[0].pageY - e.pageY) && Math.abs(this.moves[0].pageX - e.pageX) > 5 && e.cancelable) {\n          this._addTransform(e.pageX - this.moves[0].pageX);\n          this.moves.push(e);\n          e.preventDefault = true;\n        } else {\n          if (Math.abs(this.moves[0].pageX - e.pageX) > 5) {\n            this.moves[0] = e;\n          }\n        }\n      }\n      if (e.type === 'touchend' || e.type === 'mouseup') {\n        delete this.moves;\n      }\n    }\n  };\n\n  /**\n   * Move end handler, handles both touchend and mouseup events\n   * @param {Object} e The moveend event\n   */\n\n\n  Carousel.prototype._moveend = function _moveend(e) {\n    this._move(e);\n    if (!this.opts.smoothScroll) {\n      this._settle(this.moves);\n    } else {\n      this._interiaScroll(this.moves);\n    }\n    return e;\n  };\n\n  /**\n   * Resize event handler, calls change to handle any element dimension changes\n   */\n\n\n  Carousel.prototype._resize = function _resize() {\n    this.change();\n  };\n\n  /**\n   * Calling the change function will handle updating the element to take into account\n   * any styling, sizing, or visibility changes, and the addition or removal of any carouselItems\n   */\n\n\n  Carousel.prototype.change = function change() {\n    var dims = this.el.getBoundingClientRect();\n    if (dims.width !== this.width || dims.height !== this.height) {\n      if (this.autoAdvance) {\n        window.clearTimeout(this.autoAdvance);\n        delete this.autoAdvance;\n      }\n      this._rafCancel();\n      var c = this._selectedItem();\n      this._setTransform(0);\n      this._setTransformItems(0);\n      this._init(this.el);\n      if (this.items.indexOf(c.el.sparkcarouselitem) > -1 && this.totalItemWidth > this.width) {\n        if (this.opts.wrapItems) {\n          this._addTransform(-this.totalItemWidth + (-c.el.sparkcarouselitem.currentPosition() + this.width / 2));\n        } else {\n          this._addTransform(-c.el.sparkcarouselitem.currentPosition() + this.width / 2);\n        }\n      }\n    }\n  };\n\n  /**\n   * Update the component to use a new element or reparse from\n   * the existing element.\n   * @param {Element} el Optional\n   */\n\n\n  Carousel.prototype.update = function update(el) {\n\n    el = el || this.el;\n\n    this._removeListeners();\n    window.removeEventListener('resize', this.resizeH);\n    delete this.resizeH;\n    document.removeEventListener('spark.visible-children', this._handleVisibleChildren, true);\n    delete this._handleVisibleChildren;\n    this._init(el);\n\n    this.change();\n\n    return this;\n  };\n\n  /**\n   * Touchstart event handler, passes necessary data points to the movestart function\n   * @param {Object} e The touchstart event\n   */\n\n\n  Carousel.prototype._touchstart = function _touchstart(e) {\n    var a = {\n      'type': e.type,\n      'pageX': e.touches[0].pageX,\n      'pageY': e.touches[0].pageY,\n      'timeStamp': e.timeStamp\n    };\n    this._movestart(a);\n  };\n\n  /**\n   * Touchmove event handler, passes necessary data points to the move function\n   * @param {Object} e The touchmove event\n   */\n\n\n  Carousel.prototype._touchmove = function _touchmove(e) {\n    var a = {\n      'type': e.type,\n      'pageX': e.touches[0].pageX,\n      'pageY': e.touches[0].pageY,\n      'timeStamp': e.timeStamp,\n      'cancelable': e.cancelable\n    };\n    this._move(a);\n    if (a.preventDefault) {\n      e.preventDefault();\n    }\n  };\n\n  /**\n   * Touchend event handler, passes necessary data points to the moveend function\n   * @param {Object} e The touchend event\n   */\n\n\n  Carousel.prototype._touchend = function _touchend(e) {\n    if (this.moves && this.moves.length > 2 && e.cancelable) {\n      var a = {\n        'type': e.type,\n        'pageX': this.moves[this.moves.length - 1].pageX,\n        'pageY': this.moves[this.moves.length - 1].pageY,\n        'timeStamp': e.timeStamp\n      };\n      this._moveend(a);\n    } else {\n      delete this.moves;\n    }\n  };\n\n  /**\n   * Mousedown event handler, passes necessary data points to the movestart function\n   * @param {Object} e The mousedown event\n   */\n\n\n  Carousel.prototype._mousedown = function _mousedown(e) {\n    if (e.button !== 0) {\n      return e;\n    }\n    this.isMouseDown = true;\n    var a = {\n      'type': e.type,\n      'pageX': e.pageX,\n      'pageY': e.pageY,\n      'timeStamp': e.timeStamp\n    };\n    this._movestart(a);\n    e.preventDefault();\n  };\n\n  /**\n   * Mousemove event handler, passes necessary data points to the move function\n   * @param {Object} e The mousemove event\n   */\n\n\n  Carousel.prototype._mousemove = function _mousemove(e) {\n    if (this.isMouseDown) {\n      var a = {\n        'type': e.type,\n        'pageX': e.clientX,\n        'pageY': e.clientY,\n        'timeStamp': e.timeStamp,\n        //this was changed to correct an issue in safari - it doesn't report cancelable correctly\n        'cancelable': true\n      };\n      this._move(a);\n      if (a.preventDefault) {\n        e.preventDefault();\n      }\n    }\n  };\n\n  /**\n   * Mouseup event handler, passes necessary data points to the moveend function\n   * @param {Object} e The mouseup event\n   */\n\n\n  Carousel.prototype._mouseup = function _mouseup(e) {\n    if (this.moves && this.moves.length > 2) {\n      var a = {\n        'type': e.type,\n        'pageX': e.pageX,\n        'pageY': e.pageY,\n        'timeStamp': e.timeStamp\n      };\n      this._moveend(a);\n      this.mouseUpHandled = true;\n    } else {\n      delete this.moves;\n      this._scrollToClicked(e);\n    }\n    this.isMouseDown = false;\n  };\n\n  /**\n   * Click event handler\n   * @param {Object} e The click event\n   */\n\n\n  Carousel.prototype._click = function _click(e) {\n    //if we are already tracking moves, then this will be handled by the mouseend event handler and we should prevent the default action\n    if (this.moves) {\n      e.preventDefault();\n    }\n    //if it has already been handled by mouseup handler, prevent the action\n    if (this.mouseUpHandled) {\n      e.preventDefault();\n    }\n    //reset our handled state\n    delete this.mouseUpHandled;\n    //checking both this.moves and this.mouseUpHandled ensures we capture events correctly in all browsers, where the order of the mouseup/click events can vary\n  };\n\n  /**\n   * Calculate the user's recent cursor/finger velocity\n   * @param {Array} moves The array of cursor positions\n   */\n\n\n  Carousel.prototype._velocity = function _velocity(moves) {\n    var avg = 0;\n    var m = Math.min(6, moves.length - 1);\n    for (var i = 1; i < m; i++) {\n      if (moves[moves.length - i].timeStamp === moves[moves.length - i - 1].timeStamp) {\n        avg += avg / i;\n      } else {\n        avg += 10 * (moves[moves.length - i].pageX - moves[moves.length - i - 1].pageX) / (moves[moves.length - i].timeStamp - moves[moves.length - i - 1].timeStamp) / m;\n      }\n    }\n    return avg;\n  };\n\n  /**\n   * Handles click events on items and dots, scrolling to the clicked item\n   * @param {Event} e The click event\n   */\n\n\n  Carousel.prototype._scrollToClicked = function _scrollToClicked(e) {\n    var tar = e.target;\n    if (this.el.contains(tar)) {\n      while (!tar.sparkcarousel) {\n        if (tar.sparkcarouselitem) {\n          this.containerMask.scrollLeft = 0;\n          delete this.moves;\n          this._rafCancel();\n          this._scrollTo(tar.sparkcarouselitem);\n          e.preventDefault();\n          break;\n        }\n        if (tar.sparkcarouselitemdot) {\n          this.containerMask.scrollLeft = 0;\n          delete this.moves;\n          this._rafCancel();\n          var v = tar.sparkcarouselitemdot.order < this._selectedItem().order ? this.opts.startingVelocity : -this.opts.startingVelocity;\n          this._scrollTo(tar.sparkcarouselitemdot, v);\n          e.preventDefault();\n          break;\n        }\n        tar = tar.parentNode;\n      }\n    }\n  };\n\n  /**\n   * Scroll to the carouselItem, with specified startingVelocity, auto determines default velocity if not specified\n   * @param {Object} item The carouselItem to scroll to\n   * @param {Number} startingVelocity The startingVelocity of the scroll animation\n   */\n\n\n  Carousel.prototype._scrollTo = function _scrollTo(item, startingVelocity) {\n    var offset = this.width / 2;\n    var currentPosition = item.currentPosition();\n    if (!startingVelocity) {\n      startingVelocity = offset - item.currentPosition() > 0 ? this.opts.startingVelocity : -this.opts.startingVelocity;\n    }\n    if (this.opts.wrapItems) {\n      if (startingVelocity > 0) {\n        //left\n        if (currentPosition > offset) {\n          this._totalDistance = offset + this.totalItemWidth - currentPosition;\n        } else {\n          this._totalDistance = offset - currentPosition;\n        }\n      } else {\n        //right\n        if (currentPosition < offset) {\n          this._totalDistance = -(this.totalItemWidth + currentPosition - offset);\n        } else {\n          this._totalDistance = offset - currentPosition;\n        }\n      }\n    } else {\n      this._totalDistance = offset - currentPosition;\n    }\n    this._startingVelocity = startingVelocity;\n    delete this.moves;\n    this._scrollToItem = true;\n    this._raf = window.requestAnimationFrame(this._rafHandler);\n  };\n\n  /**\n   * This is the animator function, it examines the options set on the carousel object\n   * and selectively adds transform and requests addtional animation frames if necesary\n   * @param {Number} t The timestamp for the current animation frame\n   */\n\n\n  Carousel.prototype._rafHandlerH = function _rafHandlerH(t) {\n    if (this.opts.autoAdvance && this.autoAdvance) {\n      window.clearTimeout(this.autoAdvance);\n      delete this.autoAdvance;\n    }\n    var frames;\n    if (this.moves || !this._startingVelocity) {\n      this._rafCancel();\n      return;\n    }\n    if (!this._laststart) {\n      this._laststart = t;\n    }\n    if (!this._remainingDistance) {\n      this._remainingDistance = this._totalDistance;\n    }\n    if (!this._lastframe) {\n      this._lastframe = t;\n      frames = 1;\n    } else {\n      frames = (t - this._lastframe) / (1 / 60 * 1000);\n    }\n    var d = this._startingVelocity * frames;\n    if (this.opts.smoothScroll && !this._scrollToItem) {\n      this._addTransform(d);\n      this._startingVelocity *= Math.pow(0.97, frames);\n      if (this.opts.smoothScrollCenterItems && Math.abs(this._startingVelocity) < 1) {\n        this._scrollTo(this._selectedItem());\n      }\n      if (Math.abs(this._startingVelocity) < 0.5) {\n        if (this._startingVelocity > 0 && this.transform.x > this.totalItemWidth / 2 - this.items[0].width / 2 || this._startingVelocity < 0 && this.transform.x < -(this.totalItemWidth / 2 - this.items[this.items.length - 1].width / 2)) {\n          this._scrollToItem = true;\n          this._scrollTo(this._selectedItem());\n        } else {\n          this._rafCancel();\n        }\n      } else {\n        this._raf = window.requestAnimationFrame(this._rafHandler);\n      }\n    } else {\n      if (this._startingVelocity > 0) {\n        if (d < this._remainingDistance) {\n          this._addTransform(d);\n          this._remainingDistance -= d;\n          if (this._remainingDistance > this._totalDistance / 2) {\n            this._startingVelocity *= Math.pow(1.15, frames);\n          } else {\n            this._startingVelocity *= Math.pow(0.9, frames);\n            this._startingVelocity = this._startingVelocity > 2 ? this._startingVelocity : 2;\n          }\n          this._raf = window.requestAnimationFrame(this._rafHandler);\n        } else {\n          this._addTransform(this._remainingDistance);\n          this._rafCancel();\n        }\n      } else {\n        if (d > this._remainingDistance) {\n          this._addTransform(d);\n          this._remainingDistance -= d;\n          if (this._remainingDistance < this._totalDistance / 2) {\n            this._startingVelocity *= Math.pow(1.15, frames);\n          } else {\n            this._startingVelocity *= Math.pow(0.9, frames);\n            this._startingVelocity = this._startingVelocity < -2 ? this._startingVelocity : -2;\n          }\n          this._raf = window.requestAnimationFrame(this._rafHandler);\n        } else {\n          this._addTransform(this._remainingDistance);\n          this._rafCancel();\n        }\n      }\n    }\n    this._lastframe = t;\n  };\n\n  /**\n   * This is the animator clearing function\n   * it clears values used during animation, and selectively enables autoAdvance\n   */\n\n\n  Carousel.prototype._rafCancel = function _rafCancel() {\n    if (this.opts.autoAdvance && !this.autoAdvance && !this.pause) {\n      this.autoAdvance = window.setTimeout(function () {\n        this._autoAdvance();\n      }.bind(this), this.opts.autoAdvance * 1000);\n    }\n    window.cancelAnimationFrame(this._raf);\n    delete this._scrollToItem;\n    delete this._laststart;\n    delete this._startingVelocity;\n    delete this._remainingDistance;\n    delete this._totalDistance;\n    delete this._lastframe;\n  };\n\n  /**\n   * This computes values necessary to start an animation frame when the carousel is\n   * configured to use smoothScroll\n   * @param {Array} moves The captured move events\n   */\n\n\n  Carousel.prototype._interiaScroll = function _interiaScroll(moves) {\n    if (moves[moves.length - 1].timeStamp - moves[moves.length - 2].timeStamp > 100 || moves.length < 3) {\n      if (this.opts.smoothScrollCenterItems) {\n        return this._scrollTo(this._selectedItem());\n      }\n      return;\n    }\n    this._startingVelocity = this._velocity(moves);\n    delete this.moves;\n    this._raf = window.requestAnimationFrame(this._rafHandler);\n  };\n\n  /**\n   * This determines which carousel item should be focused based on the previous moves\n   * made by the user\n   * @param {Array} moves The captured move events\n   */\n\n\n  Carousel.prototype._settle = function _settle(moves) {\n    if (moves && moves.length > 3) {\n      if (moves[moves.length - 1].timeStamp - moves[moves.length - 2].timeStamp > 80) {\n        return this._scrollTo(this._selectedItem());\n      }\n      var v1 = 10 * (moves[moves.length - 3].pageX - moves[moves.length - 4].pageX) / (moves[moves.length - 3].timeStamp - moves[moves.length - 4].timeStamp);\n      var v2 = 10 * (moves[moves.length - 2].pageX - moves[moves.length - 3].pageX) / (moves[moves.length - 2].timeStamp - moves[moves.length - 3].timeStamp);\n      if (Math.abs(v1) < Math.abs(v2) || Math.abs(v2) > 0.5 && Math.abs(v2) > 0.5) {\n        //user is probably trying to go to next or prev item\n        var s = this.items.indexOf(this._selectedItem());\n        if (v2 > 0) {\n          //prev\n          if (s > 0) {\n            this._scrollTo(this.items[s - 1], v2);\n          } else {\n            if (this.opts.wrapItems) {\n              this._scrollTo(this.items[this.items.length - 1], v2);\n            } else {\n              this._scrollTo(this.items[0]);\n            }\n          }\n        } else {\n          //next\n          if (s < this.items.length - 1) {\n            this._scrollTo(this.items[s + 1], v2);\n          } else {\n            if (this.opts.wrapItems) {\n              this._scrollTo(this.items[0], v2);\n            } else {\n              this._scrollTo(this.items[this.items.length - 1]);\n            }\n          }\n        }\n      } else {\n        if (this._selectedItem().currentPosition() > this.width / 2) {\n          this._scrollTo(this._selectedItem(), -this.opts.startingVelocity);\n        } else {\n          this._scrollTo(this._selectedItem(), this.opts.startingVelocity);\n        }\n      }\n    }\n  };\n\n  /**\n   * Transforms the position of all carouselItems\n   * @param {Number} x The pixel value to transform\n   */\n\n\n  Carousel.prototype._transformItems = function _transformItems(x) {\n    for (var i = 0; i < this.items.length; i++) {\n      this.items[i].addTransform(x);\n    }\n  };\n\n  /**\n   * Sets the transform position of all carouselItems\n   * @param {Number} x The pixel value to transform\n   */\n\n\n  Carousel.prototype._setTransformItems = function _setTransformItems(x) {\n    for (var i = 0; i < this.items.length; i++) {\n      this.items[i].setTransform(x);\n    }\n  };\n\n  /**\n   * Adds transform to the container element, does checking for bounds conditions and\n   * wraps items if necessary and configured\n   * @param {Number} x The pixel value to transform\n   */\n\n\n  Carousel.prototype._addTransform = function _addTransform(x) {\n    var a;\n    if ((this.opts.smoothScrollCenterItems || !this.opts.smoothScroll) && !this.opts.wrapItems && !this.opts.edgeScroll) {\n      var l = this.items.indexOf(this.selectedItem);\n      if (l === this.items.length - 1) {\n        this._leftbound(true);\n      } else {\n        this._leftbound(false);\n      }\n      if (l === 0) {\n        this._rightbound(true);\n      } else {\n        this._rightbound(false);\n      }\n    } else {\n      this._leftbound(false);\n      this._rightbound(false);\n    }\n    if (this.transform.x + x < 0 && x < 0) {\n      if (this.opts.wrapItems) {\n        //wrap items until we have covered the visible area\n        while (this.transform.x + x < -(this.totalItemWidth - this.width) / 2 && (this.totalItemWidth < this.width ? this.transform.x + x < -this.totalItemWidth / 2 : true)) {\n          a = this.items.shift();\n          this.items.push(a);\n          a.addTransform(this.totalItemWidth);\n          this._transformItems(-a.width);\n          x += a.width;\n        }\n      } else {\n        //there is a 1 pixel adjustment to account for some math rounding\n        if (this.opts.edgeScroll && x < 0 && this.transform.x + x - 1 <= -(this.totalItemWidth - this.width) / 2) {\n          this._leftbound(true);\n          return this._setTransform(-(this.totalItemWidth - this.width) / 2);\n        }\n        //progressively reduce scrolling when no more items to the right\n        if (x < 0 && this.transform.x + x < -(this.totalItemWidth / 2 - this.items[this.items.length - 1].width / 2)) {\n          x = x * ((this.totalItemWidth / 2 + this.items[this.items.length - 1].width / 2 + (this.transform.x + x)) / this.items[this.items.length - 1].width);\n          x = x > 0 ? 0 : x;\n        }\n      }\n      return this._setTransform(this.transform.x + x);\n    } else {\n      if (this.transform.x + x > 0 && x > 0) {\n        if (this.opts.wrapItems) {\n          //wrap items until we have covered the visible area\n          while (this.transform.x + x > -(this.width - this.totalItemWidth) / 2 && (this.totalItemWidth < this.width ? this.transform.x + x > this.totalItemWidth / 2 : true)) {\n            a = this.items.pop();\n            this.items.unshift(a);\n            a.addTransform(-this.totalItemWidth);\n            this._transformItems(a.width);\n            x -= a.width;\n          }\n        } else {\n          //there is a 1 pixel adjustment to account for some math rounding\n          if (this.opts.edgeScroll && x > 0 && this.transform.x + x + 1 >= (this.totalItemWidth - this.width) / 2) {\n            this._rightbound(true);\n            return this._setTransform((this.totalItemWidth - this.width) / 2);\n          }\n          //progressively reduce scrolling when no more items to the left\n          if (x > 0 && this.transform.x + x > this.totalItemWidth / 2 - this.items[0].width / 2) {\n            x = x * ((this.totalItemWidth / 2 + this.items[0].width / 2 - (this.transform.x + x)) / this.items[0].width);\n            x = x < 0 ? 0 : x;\n          }\n        }\n      }\n      return this._setTransform(this.transform.x + x);\n    }\n  };\n\n  /**\n   * Sets the leftbound class\n   * @param {Boolean} b Set or unset the leftbound class\n   */\n\n\n  Carousel.prototype._leftbound = function _leftbound(b) {\n    if (typeof b === 'undefined') {\n      this.leftbound = typeof this.leftbound === 'undefined' ? false : this.leftbound;\n      return this.leftbound;\n    } else {\n      if (b) {\n        (0, _addClass2.default)(this.el, 'leftbound');\n      } else {\n        (0, _removeClass2.default)(this.el, 'leftbound');\n      }\n      this.leftbound = b;\n      return this.leftbound;\n    }\n  };\n\n  /**\n   * Sets the rightbound class\n   * @param {Boolean} b Set or unset the rightbound class\n   */\n\n\n  Carousel.prototype._rightbound = function _rightbound(b) {\n    if (typeof b === 'undefined') {\n      this.rightbound = typeof this.rightbound === 'undefined' ? false : this.rightbound;\n      return this.rightbound;\n    } else {\n      if (b) {\n        (0, _addClass2.default)(this.el, 'rightbound');\n      } else {\n        (0, _removeClass2.default)(this.el, 'rightbound');\n      }\n      this.rightbound = b;\n      return this.rightbound;\n    }\n  };\n\n  /**\n   * Updates the selected item, by seeing which item has its center closest\n   * to the center of the carousel\n   */\n\n\n  Carousel.prototype._updateSelected = function _updateSelected() {\n    var tar = this.width / 2;\n    var i = -1;\n    var a = 1;\n    var b = 0;\n    while (a > b) {\n      i++;\n      if (i > this.items.length - 2) {\n        break;\n      }\n      a = Math.abs(tar - this.items[i].currentPosition());\n      b = Math.abs(tar - this.items[i + 1].currentPosition());\n    }\n    return this._selectedItem(this.items[i]);\n  };\n\n  /**\n   * Stores the selected item for the carousel, and updates the previously\n   * selected item and newly selected item to have the correct states\n   * Conditionally sets the leftbound/rightbound states depending on configuration\n   * @param {Object} item Optional: the new item select, if omitted it will\n   * return the currently selected item.\n   */\n\n\n  Carousel.prototype._selectedItem = function _selectedItem(item) {\n    if ((typeof item === 'undefined' ? 'undefined' : _typeof(item)) !== 'object') {\n      if (this.selectedItem) {\n        return this.selectedItem;\n      } else {\n        return this._updateSelected();\n      }\n    } else {\n      if (this.selectedItem) {\n        this.selectedItem.setSelected(false);\n      }\n      this.selectedItem = item;\n      if ((this.opts.smoothScrollCenterItems || !this.opts.smoothScroll) && !this.opts.wrapItems && !this.opts.edgeScroll) {\n        var l = this.items.indexOf(this.selectedItem);\n        if (l === this.items.length - 1) {\n          this._leftbound(true);\n        } else {\n          this._leftbound(false);\n        }\n        if (l === 0) {\n          this._rightbound(true);\n        } else {\n          this._rightbound(false);\n        }\n      }\n      this.selectedItem.setSelected(true);\n    }\n  };\n\n  /**\n   * Sets the transform for the carousel container\n   * @param {Number} x The pixel value to transform\n   */\n\n\n  Carousel.prototype._setTransform = function _setTransform(x) {\n    x = x ? x : 0;\n    this.transform = {\n      'x': x\n    };\n    this.container.setAttribute('style', (0, _transform2.default)('translate3d', x + 'px, 0px, 0px'));\n    this._updateSelected();\n    return x;\n  };\n\n  return Carousel;\n}(_base2.default);\n\n/**\n * Default values for internal properties we will be setting.\n * These are set on each construction so we don't leak properties\n * into the prototype chain.\n * @type {Object}\n */\n\n\nCarousel.prototype.defaults = {\n  el: null\n};\n\n/**\n * Whitelisted parameters which can be set on construction.\n * @type {Array}\n */\nCarousel.prototype._whitelistedParams = [];\n\nexports.default = Carousel;\nmodule.exports = exports['default'];\n//# sourceMappingURL=carousel.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; /**\n                                                                                                                                                                                                                                                                               * # Transform\n                                                                                                                                                                                                                                                                               * Apply a cross-browser transform style.\n                                                                                                                                                                                                                                                                               *\n                                                                                                                                                                                                                                                                               * @example\n                                                                                                                                                                                                                                                                               * transform('translateX', '-100px');\n                                                                                                                                                                                                                                                                               *\n                                                                                                                                                                                                                                                                               * @param {String} type\n                                                                                                                                                                                                                                                                               * @param {String} val\n                                                                                                                                                                                                                                                                               *\n                                                                                                                                                                                                                                                                               * @module helpers/css/transform.js\n                                                                                                                                                                                                                                                                               */\n\nvar _each = require('../util/each');\n\nvar _each2 = _interopRequireDefault(_each);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar prefixes = ['-webkit-', '-moz-', '-o-', '-ms-', ''];\n\nfunction transform(type, val) {\n\n  var str = '';\n\n  (0, _each2.default)(prefixes, function (p) {\n\n    if ((typeof val === 'undefined' ? 'undefined' : _typeof(val)) === 'object') {\n      str += p + 'transform: ';\n\n      for (var j in val) {\n        str += j + '(' + val[j] + '); ';\n      }\n    } else {\n      str += p + 'transform: ' + type + '(' + val + '); ';\n    }\n  });\n\n  return str;\n}\n\nexports.default = transform;\nmodule.exports = exports['default'];\n//# sourceMappingURL=transform.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _trim = require('../util/trim');\n\nvar _trim2 = _interopRequireDefault(_trim);\n\nvar _hasClass = require('./has-class');\n\nvar _hasClass2 = _interopRequireDefault(_hasClass);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * # Add Class\n * Add a class on an element.\n *\n * @param {Element|Array} el An element or array of elements to update.\n * @param {String} name\n * @return {Element}\n *\n * @module helpers/dom/add-class.js\n */\n\nvar ws = /\\s+/;\nvar cleanup = /\\s{2,}/g;\n\nfunction addClass(el, name) {\n\n  if (arguments.length === 2 && typeof name === 'string') {\n    name = (0, _trim2.default)(name).split(ws);\n  } else {\n    name = name instanceof Array ? name : Array.prototype.slice.call(arguments, 1);\n  }\n\n  // optimize for best, most common case\n  if (name.length === 1 && el.classList) {\n    if (name[0]) {\n      el.classList.add(name[0]);\n    }\n    return el;\n  }\n\n  var toAdd = [];\n  var i = 0;\n  var l = name.length;\n  var item = void 0;\n  var clsName = typeof el.className === 'string' ? el.className : el.getAttribute ? el.getAttribute('class') : '';\n\n  // see if we have anything to add\n  for (; i < l; i++) {\n    item = name[i];\n    if (item && !(0, _hasClass2.default)(clsName, item)) {\n      toAdd.push(item);\n    }\n  }\n\n  if (toAdd.length) {\n    if (typeof el.className === 'string') {\n      el.className = (0, _trim2.default)((clsName + ' ' + toAdd.join(' ')).replace(cleanup, ' '));\n    } else if (el.setAttribute) {\n      el.setAttribute('class', (0, _trim2.default)((clsName + ' ' + toAdd.join(' ')).replace(cleanup, ' ')));\n    }\n  }\n\n  return el;\n}\n\nexports.default = addClass;\nmodule.exports = exports['default'];\n//# sourceMappingURL=add-class.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\n/**\n * # Has Class\n * See if an element has a class.\n *\n * @param {Element|String} el\n * @param {String} name\n * @return {Boolean}\n *\n * @module helpers/dom/has-class.js\n */\nfunction hasClass(el, name) {\n  var cName = ((typeof el === 'undefined' ? 'undefined' : _typeof(el)) === 'object' ? el.className || el.getAttribute && el.getAttribute('class') || '' : el || '').replace(/[\\t\\r\\n\\f]/g, ' ');\n  return (' ' + cName + ' ').indexOf(' ' + name + ' ') !== -1;\n}\n\nexports.default = hasClass;\nmodule.exports = exports['default'];\n//# sourceMappingURL=has-class.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _trim = require('../util/trim');\n\nvar _trim2 = _interopRequireDefault(_trim);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar ws = /\\s+/; /**\n                 * # Remove Class\n                 * Remove a class on an element.\n                 *\n                 * @param {Element|Array} el An element or array of elements to update.\n                 * @param {String} name\n                 * @return {Element}\n                 *\n                 * @module helpers/dom/remove-class.js\n                 */\n\nvar cleanup = /\\s{2,}/g;\n\nfunction removeClass(el, name) {\n\n  if (arguments.length === 2 && typeof name === 'string') {\n    name = (0, _trim2.default)(name).split(ws);\n  } else {\n    name = name instanceof Array ? name : Array.prototype.slice.call(arguments, 1);\n  }\n\n  // optimize for best, most common case\n  if (name.length === 1 && el.classList) {\n    if (name[0]) el.classList.remove(name[0]);\n    return el;\n  }\n\n  // store two copies\n  var clsName = ' ' + (typeof el.className === 'string' ? el.className : el.getAttribute ? el.getAttribute('class') : '') + ' ';\n  var result = clsName;\n  var current = void 0;\n  var start = void 0;\n  for (var i = 0, l = name.length; i < l; i++) {\n    current = name[i];\n    start = current ? result.indexOf(' ' + current + ' ') : -1;\n    if (start !== -1) {\n      start += 1;\n      result = result.slice(0, start) + result.slice(start + current.length);\n    }\n  }\n\n  // only write if modified\n  if (clsName !== result) {\n    if (typeof el.className === 'string') {\n      el.className = (0, _trim2.default)(result.replace(cleanup, ' '));\n    } else if (el.setAttribute) {\n      el.setAttribute('class', (0, _trim2.default)(result.replace(cleanup, ' ')));\n    }\n  }\n\n  return el;\n}\n\nexports.default = removeClass;\nmodule.exports = exports['default'];\n//# sourceMappingURL=remove-class.js.map\n","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\n * # Debounce\n * Debounce a function call\n *\n * @param {Function} func\n * @param {Integer} delay\n *\n * @module helpers/util/debounce.js\n */\nfunction debounce(func, delay) {\n\n  var timer = void 0;\n\n  return function () {\n    var args = arguments;\n    if (timer) window.clearTimeout(timer);\n    timer = window.setTimeout(function () {\n      func.apply(this, args);\n    }, delay);\n  };\n}\n\nexports.default = debounce;\nmodule.exports = exports[\"default\"];\n//# sourceMappingURL=debounce.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\n * # Each\n * Apply a callback function to a list of any kind: Array, NodeList, HTMLCollection or Object.\n *\n * @param {Array|NodeList|HTMLCollection|Object} list\n * @param {Function} cb\n *\n * @example\n * each([], callback);\n * each(el.children, callback);\n * each(el.childNodes, callback);\n * each({}, callback);\n *\n * @module helpers/util/each.js\n */\nfunction each(list, cb) {\n\n  if (!list) {\n    return;\n  }\n\n  if (typeof cb !== 'function') {\n    throw new Error('Cannot invoke `each` without a callback!');\n  }\n\n  var i = 0;\n  var len = list.length;\n\n  // Object\n  if (len === undefined) {\n    for (i in list) {\n      if (i !== 'prototype' && list.hasOwnProperty(i)) {\n        cb(i, list[i]);\n      }\n    }\n  }\n  // Array-like\n  else {\n      for (; i < len; i++) {\n        cb(list[i]);\n      }\n    }\n}\n\nexports.default = each;\nmodule.exports = exports['default'];\n//# sourceMappingURL=each.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\n * # Trim\n * Trim whitespace on a string.\n *\n * @param {String} str\n *\n * @module helpers/util/trim.js\n */\n\nvar trimRE = /^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g;\n\nfunction trim(str) {\n  return str.replace(trimRE, '');\n}\n\nexports.default = trim;\nmodule.exports = exports['default'];\n//# sourceMappingURL=trim.js.map\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJqcy9kaXN0L2NvbXBvbmVudHMvYmFzZS5qcyIsImpzL2Rpc3QvY29tcG9uZW50cy9jYXJvdXNlbC5qcyIsImpzL2Rpc3QvaGVscGVycy9jc3MvdHJhbnNmb3JtLmpzIiwianMvZGlzdC9oZWxwZXJzL2RvbS9hZGQtY2xhc3MuanMiLCJqcy9kaXN0L2hlbHBlcnMvZG9tL2hhcy1jbGFzcy5qcyIsImpzL2Rpc3QvaGVscGVycy9kb20vcmVtb3ZlLWNsYXNzLmpzIiwianMvZGlzdC9oZWxwZXJzL3V0aWwvZGVib3VuY2UuanMiLCJqcy9kaXN0L2hlbHBlcnMvdXRpbC9lYWNoLmpzIiwianMvZGlzdC9oZWxwZXJzL3V0aWwvdHJpbS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4SkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOXBDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbERBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2VhY2ggPSByZXF1aXJlKCcuLi9oZWxwZXJzL3V0aWwvZWFjaCcpO1xuXG52YXIgX2VhY2gyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZWFjaCk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9IC8qKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICMgQmFzZSBDb21wb25lbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBUaGUgYmFzZSBjbGFzcyBmb3IgU3BhcmsgSlMgY29tcG9uZW50cy4gVGhpcyBjbGFzcyBzaG91bGQgbmV2ZXIgYmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBpbnN0YW50aWF0ZWQgZGlyZWN0bHkuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IHBhcmFtc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQG1vZHVsZSBjb21wb25lbnRzL2Jhc2UuanNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxudmFyIG5vb3AgPSBmdW5jdGlvbiBub29wKCkge307XG5cbnZhciBCYXNlID0gZnVuY3Rpb24gKCkge1xuXG4gIC8qKlxuICAgKiBTZXQgcGFyYW1ldGVycyBhbmQgY2FjaGUgZWxlbWVudHMuXG4gICAqL1xuICBmdW5jdGlvbiBCYXNlKGVsKSB7XG4gICAgdmFyIHBhcmFtcyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307XG5cbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQmFzZSk7XG5cbiAgICBpZiAocGFyYW1zLmVsUmVxdWlyZWQgJiYgIWVsKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5zZXRQYXJhbXModGhpcy5kZWZhdWx0cyB8fCB7fSwgdHJ1ZSk7XG4gICAgdGhpcy5zZXRQYXJhbXMocGFyYW1zKTtcbiAgICAodGhpcy5fY2FjaGVFbGVtZW50cyB8fCBub29wKS5jYWxsKHRoaXMsIGVsLCBwYXJhbXMpO1xuICAgICh0aGlzLl9wYXJzZVBhcmFtcyB8fCBub29wKS5jYWxsKHRoaXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSB0aGUgY29tcG9uZW50IGZyb20gdGhlIERPTSBhbmQgcHJlcGFyZSBmb3IgZ2FyYmFnZSBjb2xsZWN0aW9uIGJ5IGRlcmVmZXJlbmNpbmcgdmFsdWVzLlxuICAgKiBAcGFyYW0ge0Jvb2xlYW59IGxlYXZlRWxlbWVudCBMZWF2ZSB0aGUgZWxlbWVudCBpbnRhY3QuXG4gICAqL1xuXG5cbiAgQmFzZS5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gcmVtb3ZlKGxlYXZlRWxlbWVudCkge1xuXG4gICAgaWYgKHRoaXMuX3JlbW92ZUV2ZW50TGlzdGVuZXJzKSB7XG4gICAgICB0aGlzLl9yZW1vdmVFdmVudExpc3RlbmVycygpO1xuICAgIH1cblxuICAgIGlmICghbGVhdmVFbGVtZW50ICYmIHRoaXMuZWwgJiYgdGhpcy5lbC5wYXJlbnROb2RlKSB7XG4gICAgICB0aGlzLmVsLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5lbCk7XG4gICAgfVxuXG4gICAgdGhpcy51bnNldFBhcmFtcyh0aGlzLmRlZmF1bHRzKTtcblxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBVcGRhdGUgdGhlIGNvbXBvbmVudCB0byB1c2UgYSBuZXcgZWxlbWVudCBvciByZXBhcnNlIGZyb21cbiAgICogdGhlIGV4aXN0aW5nIGVsZW1lbnQuXG4gICAqIEBwYXJhbSB7RWxlbWVudH0gZWwgT3B0aW9uYWxcbiAgICogQHBhcmFtIHtPYmplY3R9IHBhcmFtcyBPcHRpb25hbFxuICAgKi9cblxuXG4gIEJhc2UucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uIHVwZGF0ZShlbCkge1xuICAgIHZhciBwYXJhbXMgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHt9O1xuXG5cbiAgICBpZiAodGhpcy5fcmVtb3ZlRXZlbnRMaXN0ZW5lcnMpIHtcbiAgICAgIHRoaXMuX3JlbW92ZUV2ZW50TGlzdGVuZXJzKCk7XG4gICAgfVxuXG4gICAgKHRoaXMuX2NhY2hlRWxlbWVudHMgfHwgbm9vcCkuY2FsbCh0aGlzLCBlbCB8fCB0aGlzLmVsLCBwYXJhbXMpO1xuICAgICh0aGlzLl9wYXJzZVBhcmFtcyB8fCBub29wKS5jYWxsKHRoaXMpO1xuXG4gICAgaWYgKHRoaXMuX2FkZEV2ZW50TGlzdGVuZXJzKSB7XG4gICAgICB0aGlzLl9hZGRFdmVudExpc3RlbmVycygpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBTZXQgYSBoYXNoIG9mIHBhcmFtZXRlcnMgaWYgdGhleSdyZSB3aGl0ZWxpc3RlZCBvciB3ZSdyZSB0b2xkIHRvIGZvcmNlIHRoZSBzZXQuXG4gICAqIFRoaXMgaXMgdXNlZCB0byBzZXQgaW5pdGlhbCB2YWx1ZXMgYXMgd2VsbCBhcyBzZXQgcGFzc2VkIHBhcmFtZXRlcnMuXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBwYXJhbXNcbiAgICogQHBhcmFtIHtCb29sZWFufSBmb3JjZSBGb3JjZSBzZXR0aW5nIGV2ZW4gaWYgdGhlIHBhcmFtIGlzIG5vdCB3aGl0ZWxpc3RlZC5cbiAgICovXG5cblxuICBCYXNlLnByb3RvdHlwZS5zZXRQYXJhbXMgPSBmdW5jdGlvbiBzZXRQYXJhbXMocGFyYW1zLCBmb3JjZSkge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICAoMCwgX2VhY2gyLmRlZmF1bHQpKHBhcmFtcywgZnVuY3Rpb24gKGssIHYpIHtcbiAgICAgIGlmIChfdGhpcy5fd2hpdGVsaXN0ZWRQYXJhbXMuaW5kZXhPZihrKSAhPT0gLTEgfHwgZm9yY2UpIHtcbiAgICAgICAgX3RoaXNba10gPSB2O1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIFVuc2V0IGFsbCBwYXJhbWV0ZXJzLlxuICAgKiBAcGFyYW0ge0FycmF5fE9iamVjdH0ga2V5c1xuICAgKiBAcGFyYW0ge09iamVjdH0gc2NvcGUgVGhlIG9iamVjdCB0byB1bnNldCB0aGUgcGFyYW1zIGZyb20uIERlZmF1bHRzIHRvIGB0aGlzYC5cbiAgICovXG5cblxuICBCYXNlLnByb3RvdHlwZS51bnNldFBhcmFtcyA9IGZ1bmN0aW9uIHVuc2V0UGFyYW1zKGtleXMsIHNjb3BlKSB7XG5cbiAgICBrZXlzID0ga2V5cyBpbnN0YW5jZW9mIEFycmF5ID8ga2V5cyA6IE9iamVjdC5rZXlzKGtleXMpO1xuICAgIHNjb3BlID0gc2NvcGUgfHwgdGhpcztcbiAgICAoMCwgX2VhY2gyLmRlZmF1bHQpKGtleXMsIGZ1bmN0aW9uIChrKSB7XG4gICAgICBkZWxldGUgc2NvcGVba107XG4gICAgfSk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICByZXR1cm4gQmFzZTtcbn0oKTtcblxuLyoqXG4gKiBXaGl0ZWxpc3RlZCBwYXJhbWV0ZXJzIHdoaWNoIGNhbiBiZSBzZXQgb24gY29uc3RydWN0aW9uLlxuICogQHR5cGUge0FycmF5fVxuICovXG5cblxuQmFzZS5wcm90b3R5cGUuX3doaXRlbGlzdGVkUGFyYW1zID0gW107XG5cbi8qKlxuICogRGVmYXVsdCB2YWx1ZXMgZm9yIGludGVybmFsIHByb3BlcnRpZXMgd2Ugd2lsbCBiZSBzZXR0aW5nLlxuICogVGhlc2UgYXJlIHNldCBvbiBlYWNoIGNvbnN0cnVjdGlvbiBzbyB3ZSBkb24ndCBsZWFrIHByb3BlcnRpZXNcbiAqIGludG8gdGhlIHByb3RvdHlwZSBjaGFpbi5cbiAqIEB0eXBlIHtPYmplY3R9XG4gKi9cbkJhc2UucHJvdG90eXBlLmRlZmF1bHRzID0ge307XG5cbmV4cG9ydHMuZGVmYXVsdCA9IEJhc2U7XG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJhc2UuanMubWFwXG4iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfdHlwZW9mID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09IFwic3ltYm9sXCIgPyBmdW5jdGlvbiAob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9IDogZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyBcInN5bWJvbFwiIDogdHlwZW9mIG9iajsgfTtcblxudmFyIF9iYXNlID0gcmVxdWlyZSgnLi9iYXNlJyk7XG5cbnZhciBfYmFzZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9iYXNlKTtcblxudmFyIF9kZWJvdW5jZSA9IHJlcXVpcmUoJy4uL2hlbHBlcnMvdXRpbC9kZWJvdW5jZScpO1xuXG52YXIgX2RlYm91bmNlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2RlYm91bmNlKTtcblxudmFyIF90cmFuc2Zvcm0gPSByZXF1aXJlKCcuLi9oZWxwZXJzL2Nzcy90cmFuc2Zvcm0nKTtcblxudmFyIF90cmFuc2Zvcm0yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdHJhbnNmb3JtKTtcblxudmFyIF9hZGRDbGFzcyA9IHJlcXVpcmUoJy4uL2hlbHBlcnMvZG9tL2FkZC1jbGFzcycpO1xuXG52YXIgX2FkZENsYXNzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2FkZENsYXNzKTtcblxudmFyIF9yZW1vdmVDbGFzcyA9IHJlcXVpcmUoJy4uL2hlbHBlcnMvZG9tL3JlbW92ZS1jbGFzcycpO1xuXG52YXIgX3JlbW92ZUNsYXNzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlbW92ZUNsYXNzKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfSAvKipcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICMgQ2Fyb3VzZWxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENyZWF0ZSBhIENhcm91c2VsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQGV4YW1wbGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIG5ldyBDYXJvdXNlbChlbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQG1vZHVsZSBjb21wb25lbnRzL2Nhcm91c2VsLmpzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxudmFyIENhcm91c2VsID0gZnVuY3Rpb24gKF9CYXNlQ29tcG9uZW50KSB7XG4gIF9pbmhlcml0cyhDYXJvdXNlbCwgX0Jhc2VDb21wb25lbnQpO1xuXG4gIC8qKlxuICAgKiBDYXJvdXNlbCBjb25zdHJ1Y3Rvci5cbiAgICogQHBhcmFtIHtFbGVtZW50fSBlbFxuICAgKiBAcGFyYW0ge09iamVjdH0gcGFyYW1zXG4gICAqL1xuICBmdW5jdGlvbiBDYXJvdXNlbChlbCwgcGFyYW1zKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENhcm91c2VsKTtcblxuICAgIHZhciBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIF9CYXNlQ29tcG9uZW50LmNhbGwodGhpcywgZWwsIHBhcmFtcykpO1xuXG4gICAgcGFyYW1zID0gcGFyYW1zIHx8IHt9O1xuXG4gICAgaWYgKCFlbCkge1xuICAgICAgcmV0dXJuIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKF90aGlzKTtcbiAgICB9XG5cbiAgICBfdGhpcy5faW5pdChlbCk7XG4gICAgcmV0dXJuIF90aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIENhcm91c2VsIEl0ZW0gQ29udHJ1Y3RvciwgZXhwb3NlcyBhY2Nlc3MgdG8gZnVuY3Rpb25zIHNldFRyYW5zZm9ybSwgc2V0U2VsZWN0ZWQsIGFuZCBjdXJyZW50UG9zaXRpb25cbiAgICogQHBhcmFtIHtFbGVtZW50fSBlbCBOb2RlIHRvIGluaXRhbGl6ZSBhcyBjYXJvdXNlbEl0ZW1cbiAgICogQHBhcmFtIHtPYmplY3R9IHBhcmVudCByZWZlcmVuY2UgdG8gdGhlIHBhcmVudCBjYXJvdXNlbFxuICAgKiBAcGFyYW0ge0VsZW1lbnR9IGRvdCBOb2RlIHRvIHVzZSBhcyBkb3QgZWxlbWVudFxuICAgKiBAcGFyYW0ge051bWJlcn0gb3JkZXIgb3JpZ2luYWwgb3JkZXIgaW4gdGhlIG1hcmt1cFxuICAgKi9cblxuXG4gIENhcm91c2VsLnByb3RvdHlwZS5fY2Fyb3VzZWxJdGVtID0gZnVuY3Rpb24gX2Nhcm91c2VsSXRlbShlbCwgcGFyZW50LCBkb3QsIG9yZGVyKSB7XG4gICAgdmFyIGEgPSB7fTtcbiAgICBhLmVsID0gZWw7XG4gICAgYS5wYXJlbnQgPSBwYXJlbnQ7XG4gICAgYS5kb3QgPSBkb3Q7XG4gICAgYS5vcmRlciA9IG9yZGVyO1xuICAgIGEuYWRkVHJhbnNmb3JtID0gZnVuY3Rpb24gKHgpIHtcbiAgICAgIGEuc2V0VHJhbnNmb3JtKGEudHJhbnNmb3JtLnggKyB4KTtcbiAgICB9O1xuICAgIGEuc2V0VHJhbnNmb3JtID0gZnVuY3Rpb24gKHgpIHtcbiAgICAgIHggPSB4ID8geCA6IDA7XG4gICAgICBhLnRyYW5zZm9ybSA9IHtcbiAgICAgICAgJ3gnOiB4XG4gICAgICB9O1xuICAgICAgYS5lbC5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgKDAsIF90cmFuc2Zvcm0yLmRlZmF1bHQpKCd0cmFuc2xhdGUzZCcsIGEudHJhbnNmb3JtLnggKyAncHgsIDBweCwgMHB4JykpO1xuICAgIH07XG4gICAgYS5zZXRTZWxlY3RlZCA9IGZ1bmN0aW9uIChiKSB7XG4gICAgICBpZiAoYS5zZXRTZWxlY3RlZC5zZWxlY3RlZCA9PT0gYiAmJiB0eXBlb2YgYS5zZXRTZWxlY3RlZC5zZWxlY3RlZCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKGIpIHtcbiAgICAgICAgKDAsIF9hZGRDbGFzczIuZGVmYXVsdCkoYS5lbCwgJ3NlbGVjdGVkJyk7XG4gICAgICAgICgwLCBfYWRkQ2xhc3MyLmRlZmF1bHQpKGEuZG90LCAnc2VsZWN0ZWQnKTtcbiAgICAgICAgYS5zZXRTZWxlY3RlZC5zZWxlY3RlZCA9IHRydWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAoMCwgX3JlbW92ZUNsYXNzMi5kZWZhdWx0KShhLmVsLCAnc2VsZWN0ZWQnKTtcbiAgICAgICAgKDAsIF9yZW1vdmVDbGFzczIuZGVmYXVsdCkoYS5kb3QsICdzZWxlY3RlZCcpO1xuICAgICAgICBhLnNldFNlbGVjdGVkLnNlbGVjdGVkID0gZmFsc2U7XG4gICAgICB9XG4gICAgfTtcbiAgICBhLmN1cnJlbnRQb3NpdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBwYXJlbnQudHJhbnNmb3JtLnggKyBhLnRyYW5zZm9ybS54ICsgYS5kaW1zLmxlZnQgKyBhLndpZHRoIC8gMiAtIHBhcmVudC5kaW1zLmxlZnQ7XG4gICAgfTtcbiAgICBhLnNldFRyYW5zZm9ybSgpO1xuICAgIGEuZGltcyA9IGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIGEud2lkdGggPSBhLmRpbXMud2lkdGg7XG4gICAgYS5lbC5zcGFya2Nhcm91c2VsaXRlbSA9IGE7XG4gICAgYS5kb3Quc3BhcmtjYXJvdXNlbGl0ZW1kb3QgPSBhO1xuICAgIHJldHVybiBhO1xuICB9O1xuXG4gIC8qKlxuICAgKiBTY2FucyBlbGVtZW50IGFuZCBzZXRzIHVwIG9yIHJlc2V0cyB0aGUgY2Fyb3VzZWwgYmFzZWQgb24gY29uZmlndXJhdGlvblxuICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsIE5vZGUgdG8gaW5pdGFsaXplIGFzIHRoZSBjYXJvdXNlbFxuICAgKi9cblxuXG4gIENhcm91c2VsLnByb3RvdHlwZS5faW5pdCA9IGZ1bmN0aW9uIF9pbml0KGVsKSB7XG4gICAgLy9jYWNoZSBlbGVtZW50cyBhbmQgY29udHJvbHNcbiAgICB0aGlzLmVsID0gZWw7XG4gICAgdGhpcy5lbC5zcGFya2Nhcm91c2VsID0gdGhpcztcbiAgICB0aGlzLmJhY2tlID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcuc3BhcmstY2Fyb3VzZWxfX2JhY2snKTtcbiAgICB0aGlzLmZvcndhcmRlID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcuc3BhcmstY2Fyb3VzZWxfX2ZvcndhcmQnKTtcbiAgICB0aGlzLm91dGVyQ29udGFpbmVyID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcuc3BhcmstY2Fyb3VzZWxfX291dGVyLWNvbnRhaW5lcicpO1xuICAgIHRoaXMuY29udGFpbmVyTWFzayA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcignLnNwYXJrLWNhcm91c2VsX19jb250YWluZXItbWFzaycpO1xuICAgIHRoaXMuY29udGFpbmVyID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcuc3BhcmstY2Fyb3VzZWxfX2NvbnRhaW5lcicpO1xuICAgIHRoaXMuZG90cyA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcignLnNwYXJrLWNhcm91c2VsX19kb3RzJyk7XG4gICAgdGhpcy5wYXVzZUVsID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcuc3BhcmstY2Fyb3VzZWxfX3BhdXNlJyk7XG4gICAgLy9nZXQgdGhlIG9wdGlvbnMgZnJvbSB0aGUgZWxlbWVudFxuICAgIHRoaXMub3B0cyA9IHt9O1xuICAgIHRoaXMub3B0cy53cmFwSXRlbXMgPSB0aGlzLmVsLmF0dHJpYnV0ZXNbJ2RhdGEtc3BhcmstY2Fyb3VzZWwtd3JhcC1pdGVtcyddID8gdHJ1ZSA6IGZhbHNlO1xuICAgIHRoaXMub3B0cy5zdGFydGluZ1ZlbG9jaXR5ID0gdGhpcy5lbC5hdHRyaWJ1dGVzWydkYXRhLXNwYXJrLWNhcm91c2VsLXNjcm9sbC12ZWxvY2l0eSddID8gdGhpcy5lbC5hdHRyaWJ1dGVzWydkYXRhLXNwYXJrLWNhcm91c2VsLXNjcm9sbC12ZWxvY2l0eSddLnZhbHVlIDogMTA7XG4gICAgdGhpcy5vcHRzLnNtb290aFNjcm9sbCA9IHRoaXMuZWwuYXR0cmlidXRlc1snZGF0YS1zcGFyay1jYXJvdXNlbC1zbW9vdGgtc2Nyb2xsJ10gPyB0cnVlIDogZmFsc2U7XG4gICAgdGhpcy5vcHRzLnNtb290aFNjcm9sbENlbnRlckl0ZW1zID0gdGhpcy5lbC5hdHRyaWJ1dGVzWydkYXRhLXNwYXJrLWNhcm91c2VsLXNtb290aC1zY3JvbGwtY2VudGVyJ10gPyB0cnVlIDogZmFsc2U7XG4gICAgdGhpcy5vcHRzLnBhbmVsU2Nyb2xsID0gdGhpcy5lbC5hdHRyaWJ1dGVzWydkYXRhLXNwYXJrLWNhcm91c2VsLXBhbmVsJ10gPyB0cnVlIDogZmFsc2U7XG4gICAgdGhpcy5vcHRzLmVkZ2VTY3JvbGwgPSB0aGlzLm9wdHMucGFuZWxTY3JvbGwgfHwgdGhpcy5lbC5hdHRyaWJ1dGVzWydkYXRhLXNwYXJrLWNhcm91c2VsLWVkZ2UnXSA/IHRydWUgOiBmYWxzZTtcbiAgICB0aGlzLm9wdHMuYXV0b0FkdmFuY2UgPSB0aGlzLmVsLmF0dHJpYnV0ZXNbJ2RhdGEtc3BhcmstY2Fyb3VzZWwtYXV0by1hZHZhbmNlJ10gPyB0aGlzLmVsLmF0dHJpYnV0ZXNbJ2RhdGEtc3BhcmstY2Fyb3VzZWwtYXV0by1hZHZhbmNlJ10udmFsdWUgOiBmYWxzZTtcbiAgICAvL3NldHVwIGF1dG9BZHZhbmNlXG4gICAgaWYgKHRoaXMub3B0cy5hdXRvQWR2YW5jZSAmJiAhdGhpcy5hdXRvQWR2YW5jZSAmJiAhdGhpcy5wYXVzZSkge1xuICAgICAgdGhpcy5hdXRvQWR2YW5jZSA9IHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fYXV0b0FkdmFuY2UoKTtcbiAgICAgIH0uYmluZCh0aGlzKSwgdGhpcy5vcHRzLmF1dG9BZHZhbmNlICogMTAwMCk7XG4gICAgfVxuICAgIC8vY29uZGl0aW9uYWxseSBiaW5kIHBhdXNlIGhhbmRsZXJzLlxuICAgIC8vbmVlZHMgdG8gYmUgZG9uZSBoZXJlIHNvIHRoYXQgcmVzZXR0aW5nIHRoZSBjYXJvdXNlbCB3aWxsIHdvcmsgY29ycmVjdGx5XG4gICAgaWYgKHRoaXMub3B0cy5hdXRvQWR2YW5jZSAmJiAhdGhpcy5wYXVzZUgpIHtcbiAgICAgIHRoaXMucGF1c2VIID0gdGhpcy5fcGF1c2UuYmluZCh0aGlzKTtcbiAgICAgIHRoaXMucGF1c2VFbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMucGF1c2VIKTtcbiAgICB9XG4gICAgLy9jb2xsZWN0IGl0ZW1zIGFuZCBjYWNoZSBzaXppbmdcbiAgICB2YXIgYSA9IHRoaXMuZWwucXVlcnlTZWxlY3RvckFsbCgnLnNwYXJrLWNhcm91c2VsX19pdGVtJyk7XG4gICAgdGhpcy5pdGVtcyA9IFtdO1xuICAgIHRoaXMudG90YWxJdGVtV2lkdGggPSAwO1xuICAgIHRoaXMuZGltcyA9IHRoaXMuY29udGFpbmVyTWFzay5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICB0aGlzLndpZHRoID0gdGhpcy5kaW1zLndpZHRoO1xuICAgIHRoaXMuaGVpZ2h0ID0gdGhpcy5kaW1zLmhlaWdodDtcbiAgICB2YXIgZG90cyA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICB2YXIgYjtcbiAgICAvL2NyZWF0ZSBvdXIgY2Fyb3VzZWxJdGVtc1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYS5sZW5ndGg7IGkrKykge1xuICAgICAgYiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgZG90cy5hcHBlbmRDaGlsZChiKTtcbiAgICAgIHRoaXMuaXRlbXMucHVzaChuZXcgdGhpcy5fY2Fyb3VzZWxJdGVtKGFbaV0sIHRoaXMsIGIsIGkpKTtcbiAgICAgIHRoaXMudG90YWxJdGVtV2lkdGggKz0gdGhpcy5pdGVtc1tpXS53aWR0aDtcbiAgICB9XG4gICAgLy9pZiB3ZSdyZSByZXNldHRpbmcgd2UgbmVlZCB0byBlbXB0eSBvdXQgdGhlIGV4aXNpdGluZyBlbGVtZW50cyBmaXJzdFxuICAgIHdoaWxlICh0aGlzLmRvdHMuZmlyc3RDaGlsZCkge1xuICAgICAgdGhpcy5kb3RzLnJlbW92ZUNoaWxkKHRoaXMuZG90cy5maXJzdENoaWxkKTtcbiAgICB9XG4gICAgdGhpcy5kb3RzLmFwcGVuZENoaWxkKGRvdHMpO1xuICAgIC8vdGhpcyBpcyB0byB0ZXN0IGlmIHdlJ3JlIGRlYWxpbmcgd2l0aCAyMDExIGZsZXhib3ggKElFMTApIGFuZCBuZWVkIHRvIGRvIGFuIGFkanVzdG1lbnRcbiAgICAvL3RoaXMgaXMgYmVjYXVzZSBtcy1mbGV4LXBhY2s6IGNlbnRlciBkb2Vzbid0IHdvcmsgbGlrZSAyMDEyIGZsZXhib3ggY2VudGVyLXBhY2tcbiAgICBpZiAodHlwZW9mIHRoaXMuY29udGFpbmVyLnN0eWxlLm1zRmxleEFsaWduICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgdGhpcy5fdHJhbnNmb3JtSXRlbXMoLSh0aGlzLnRvdGFsSXRlbVdpZHRoIC0gdGhpcy53aWR0aCkgLyAyKTtcbiAgICB9XG4gICAgLy9zZXR1cCBpbml0YWwgdHJhbnNmb3JtXG4gICAgdGhpcy5fc2V0VHJhbnNmb3JtKCk7XG4gICAgLy9uZWVkIHRvIGJpbmQgdGhpcyBldmVudCBoYW5kbGVyIGhlcmUgYXMgd2UgYXJlIGFsd2F5cyBnb2luZyB0byBuZWVkIHRvIGJlIGxpc3RlbmluZ1xuICAgIC8vZm9yIHRoaXMgZXZlbnQsIGluIG9yZGVyIHRvIHJlYWN0IHRvIGNvbnRhaW5lciB2aXNpYmlsaXR5IGNoYW5naW5nXG4gICAgdGhpcy5faGFuZGxlVmlzaWJsZUNoaWxkcmVuID0gdGhpcy5faGFuZGxlVmlzaWJsZUNoaWxkcmVuSC5iaW5kKHRoaXMpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3NwYXJrLnZpc2libGUtY2hpbGRyZW4nLCB0aGlzLl9oYW5kbGVWaXNpYmxlQ2hpbGRyZW4sIHRydWUpO1xuICAgIGlmICghdGhpcy5fcmFmSGFuZGxlcikge1xuICAgICAgdGhpcy5fcmFmSGFuZGxlciA9IHRoaXMuX3JhZkhhbmRsZXJILmJpbmQodGhpcyk7XG4gICAgfVxuICAgIC8vbmVlZCB0byBhbHNvIGxpc3RlbiB0byByZXNpemUgZXZlbnRzLCBldmVuIGlmIHdlIGRvbid0IGhhdmUgaXRlbXMgb3ZlcmZsb3dpbmdcbiAgICBpZiAoIXRoaXMucmVzaXplSCkge1xuICAgICAgdGhpcy5yZXNpemVIID0gKDAsIF9kZWJvdW5jZTIuZGVmYXVsdCkodGhpcy5fcmVzaXplLmJpbmQodGhpcyksIDEwMCk7XG4gICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgdGhpcy5yZXNpemVIKTtcbiAgICB9XG4gICAgLy9pZiB3ZSBoYXZlbid0IGFscmVhZHkgaW5pdCdkIGV2ZW50IGxpc3RlcmVycywgYW5kIHdlIGhhdmUgaXRlbXMgb3ZlcmZsb3dpbmdcbiAgICBpZiAodGhpcy50b3RhbEl0ZW1XaWR0aCA+IHRoaXMud2lkdGgpIHtcbiAgICAgIGlmICghdGhpcy50b3VjaHN0YXJ0SCkge1xuICAgICAgICAoMCwgX3JlbW92ZUNsYXNzMi5kZWZhdWx0KSh0aGlzLmVsLCAnbm9zY3JvbGwnKTtcbiAgICAgICAgdGhpcy5fc2V0dXBMaXN0ZW5lcnMoKTtcbiAgICAgICAgLy9jZW50ZXIgdGhlIGZpcnN0IGl0ZW1cbiAgICAgICAgdGhpcy5fYWRkVHJhbnNmb3JtKC10aGlzLml0ZW1zWzBdLmN1cnJlbnRQb3NpdGlvbigpICsgdGhpcy53aWR0aCAvIDIpO1xuICAgICAgfVxuICAgIH1cbiAgICAvL2lmIHdlIGRvbid0IGhhdmUgb3ZlcmZsb3dpbmcgaXRlbXMsIHRoZW4gZGlzYWJsZSBzY3JvbGxpbmcgYW5kIHJlbW92ZSBsaXN0ZW5lcnNcbiAgICBlbHNlIHtcbiAgICAgICAgKDAsIF9hZGRDbGFzczIuZGVmYXVsdCkodGhpcy5lbCwgJ25vc2Nyb2xsJyk7XG4gICAgICAgIHRoaXMuX3JlbW92ZUxpc3RlbmVycygpO1xuICAgICAgfVxuICAgIC8vc2V0IHRoZSBuZXcgc2VsZWN0ZWQgaXRlbVxuICAgIHRoaXMuX3VwZGF0ZVNlbGVjdGVkKCk7XG4gICAgLy9maW5hbGx5LCBkaXNwbGF5IHRoZSBlbGVtZW50XG4gICAgKDAsIF9hZGRDbGFzczIuZGVmYXVsdCkodGhpcy5lbCwgJ3JlYWR5Jyk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFRlYXJzIGRvd24gdGhlIGNvbXBvbmVudCwgcmVtb3ZlcyBsaXN0ZW5lcnMsIGFuZCBjb25kaXRpb25hbGx5IGRlbGV0ZSB0aGUgRE9NIGVsZW1lbnRcbiAgICogQHBhcmFtIHtCb29sZWFufSBsZWF2ZUVsZW1lbnQgRmFsc2V5IHZhbHVlIHdpbGwgcmVtb3ZlIHRoZSBET00gZWxlbWVudCBhcyB3ZWxsIGFzIHRoZSBjb21wb25lbnQgaW5zdGFuY2VcbiAgICovXG5cblxuICBDYXJvdXNlbC5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gcmVtb3ZlKGxlYXZlRWxlbWVudCkge1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdyZXNpemUnLCB0aGlzLnJlc2l6ZUgpO1xuICAgIGRlbGV0ZSB0aGlzLnJlc2l6ZUg7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignc3BhcmsudmlzaWJsZS1jaGlsZHJlbicsIHRoaXMuX2hhbmRsZVZpc2libGVDaGlsZHJlbiwgdHJ1ZSk7XG4gICAgZGVsZXRlIHRoaXMuX2hhbmRsZVZpc2libGVDaGlsZHJlbjtcbiAgICBfQmFzZUNvbXBvbmVudC5wcm90b3R5cGUucmVtb3ZlLmNhbGwodGhpcywgbGVhdmVFbGVtZW50KTtcbiAgfTtcblxuICAvKipcbiAgICogUGF1c2UvdW5wYXVzZSB0aGUgYXV0b0FkdmFuY2UgZmVhdHVyZVxuICAgKi9cblxuXG4gIENhcm91c2VsLnByb3RvdHlwZS5fcGF1c2UgPSBmdW5jdGlvbiBfcGF1c2UoKSB7XG4gICAgaWYgKHRoaXMucGF1c2UpIHtcbiAgICAgIGRlbGV0ZSB0aGlzLm1vdmVzO1xuICAgICAgdGhpcy5hdXRvQWR2YW5jZSA9IHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fYXV0b0FkdmFuY2UoKTtcbiAgICAgIH0uYmluZCh0aGlzKSwgdGhpcy5vcHRzLmF1dG9BZHZhbmNlICogMTAwMCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3JhZkNhbmNlbCgpO1xuICAgICAgaWYgKCF0aGlzLm9wdHMuc21vb3RoU2Nyb2xsIHx8IHRoaXMub3B0cy5zbW9vdGhTY3JvbGxDZW50ZXJJdGVtcykge1xuICAgICAgICB0aGlzLl9zY3JvbGxUbyh0aGlzLl9zZWxlY3RlZEl0ZW0oKSk7XG4gICAgICB9XG4gICAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KHRoaXMuYXV0b0FkdmFuY2UpO1xuICAgICAgZGVsZXRlIHRoaXMuYXV0b0FkdmFuY2U7XG4gICAgfVxuICAgIHRoaXMuX3NldFBhdXNlKCF0aGlzLnBhdXNlKTtcbiAgfTtcblxuICAvKipcbiAgICogdG9nZ2xlcyB0aGUgcGF1c2UgY2xhc3Mgb24gdGhlIGVsZW1lbnRcbiAgICogQHBhcmFtIHtCb29sZWFufSBiIFRydXRoeSB2YWx1ZSB3aWxsIGdpdmUgdGhlIGVsZW1lbnQgdGhlIHBhdXNlIGNsYXNzXG4gICAqL1xuXG5cbiAgQ2Fyb3VzZWwucHJvdG90eXBlLl9zZXRQYXVzZSA9IGZ1bmN0aW9uIF9zZXRQYXVzZShiKSB7XG4gICAgaWYgKHR5cGVvZiBiID09PSAndW5kZWZpbmVkJykge1xuICAgICAgdGhpcy5wYXVzZSA9IHR5cGVvZiB0aGlzLnBhdXNlID09PSAndW5kZWZpbmVkJyA/IGZhbHNlIDogdGhpcy5wYXVzZTtcbiAgICAgIHJldHVybiB0aGlzLnBhdXNlO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoYikge1xuICAgICAgICAoMCwgX2FkZENsYXNzMi5kZWZhdWx0KSh0aGlzLmVsLCAncGF1c2UnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICgwLCBfcmVtb3ZlQ2xhc3MyLmRlZmF1bHQpKHRoaXMuZWwsICdwYXVzZScpO1xuICAgICAgfVxuICAgICAgdGhpcy5wYXVzZSA9IGI7XG4gICAgICByZXR1cm4gdGhpcy5wYXVzZTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIGZ1bmN0aW9uIGNhbGxlZCBieSB3aW5kb3cuc2V0VGltZW91dCwgd2lsbCBjaGVjayBmaXJzdCB0byBzZWUgaWYgZWxlbWVudCBpcyBpbiB1c2UgYmVmb3JlIHRyaWdnZXJpbmcgYSBzbGlkZSBhZHZhbmNlXG4gICAqL1xuXG5cbiAgQ2Fyb3VzZWwucHJvdG90eXBlLl9hdXRvQWR2YW5jZSA9IGZ1bmN0aW9uIF9hdXRvQWR2YW5jZSgpIHtcbiAgICBpZiAoIXRoaXMubW92ZXMgJiYgIXRoaXMuX2xhc3RzdGFydCAmJiAhdGhpcy5wYXVzZWQpIHtcbiAgICAgIHRoaXMuX3JhZkNhbmNlbCgpO1xuICAgICAgdmFyIGEgPSB0aGlzLml0ZW1zLmluZGV4T2YodGhpcy5fc2VsZWN0ZWRJdGVtKCkpO1xuICAgICAgdGhpcy5fc2Nyb2xsVG9JdGVtID0gdHJ1ZTtcbiAgICAgIHRoaXMuX3Njcm9sbFRvKHRoaXMuaXRlbXNbYSA9PT0gdGhpcy5pdGVtcy5sZW5ndGggLSAxID8gMCA6IGEgKyAxXSk7XG4gICAgICB0aGlzLmF1dG9BZHZhbmNlID0gd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9hdXRvQWR2YW5jZSgpO1xuICAgICAgfS5iaW5kKHRoaXMpLCB0aGlzLm9wdHMuYXV0b0FkdmFuY2UgKiAxMDAwKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIGluaXRhbGl6ZSBhbmQgYmluZCBldmVuIGxpc3RlbmVyc1xuICAgKi9cblxuXG4gIENhcm91c2VsLnByb3RvdHlwZS5fc2V0dXBMaXN0ZW5lcnMgPSBmdW5jdGlvbiBfc2V0dXBMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy50b3VjaHN0YXJ0SCA9IHRoaXMuX3RvdWNoc3RhcnQuYmluZCh0aGlzKTtcbiAgICB0aGlzLmNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgdGhpcy50b3VjaHN0YXJ0SCk7XG4gICAgdGhpcy50b3VjaG1vdmVIID0gdGhpcy5fdG91Y2htb3ZlLmJpbmQodGhpcyk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIHRoaXMudG91Y2htb3ZlSCk7XG4gICAgdGhpcy50b3VjaGVuZEggPSB0aGlzLl90b3VjaGVuZC5iaW5kKHRoaXMpO1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIHRoaXMudG91Y2hlbmRIKTtcbiAgICB0aGlzLm1vdXNlZG93bkggPSB0aGlzLl9tb3VzZWRvd24uYmluZCh0aGlzKTtcbiAgICB0aGlzLmNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLm1vdXNlZG93bkgpO1xuICAgIHRoaXMubW91c2Vtb3ZlSCA9IHRoaXMuX21vdXNlbW92ZS5iaW5kKHRoaXMpO1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0aGlzLm1vdXNlbW92ZUgpO1xuICAgIHRoaXMubW91c2V1cEggPSB0aGlzLl9tb3VzZXVwLmJpbmQodGhpcyk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCB0aGlzLm1vdXNldXBIKTtcbiAgICB0aGlzLmZvcndhcmRIID0gdGhpcy5fZm9yd2FyZC5iaW5kKHRoaXMpO1xuICAgIHRoaXMuZm9yd2FyZGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmZvcndhcmRIKTtcbiAgICB0aGlzLmJhY2tIID0gdGhpcy5fYmFjay5iaW5kKHRoaXMpO1xuICAgIHRoaXMuYmFja2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmJhY2tIKTtcbiAgICB0aGlzLmNsaWNrSCA9IHRoaXMuX2NsaWNrLmJpbmQodGhpcyk7XG4gICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuY2xpY2tIKTtcbiAgICB0aGlzLl9mb2N1c0hhbmRsZXIgPSB0aGlzLl9zY3JvbGxUb0NsaWNrZWQuYmluZCh0aGlzKTtcbiAgICB0aGlzLmNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdmb2N1cycsIHRoaXMuX2ZvY3VzSGFuZGxlciwgdHJ1ZSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFJlbW92ZXMgbm9uLWVzc2VudGlhbCBldmVudCBsaXN0ZW5lcnMsIGNhbGxlZCB3aGVuIHRlYXJpbmcgZG93biB0aGUgY29tcG9uZW50LCBvciBvdXIgY29udGVudFxuICAgKiBkb2VzIG5vdCBleGNlZWQgdGhlIHdpZHRoIG9mIG91ciBlbGVtZW50XG4gICAqL1xuXG5cbiAgQ2Fyb3VzZWwucHJvdG90eXBlLl9yZW1vdmVMaXN0ZW5lcnMgPSBmdW5jdGlvbiBfcmVtb3ZlTGlzdGVuZXJzKCkge1xuICAgIHRoaXMuZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIHRoaXMudG91Y2hzdGFydEgpO1xuICAgIGRlbGV0ZSB0aGlzLnRvdWNoc3RhcnRIO1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCB0aGlzLnRvdWNobW92ZUgpO1xuICAgIGRlbGV0ZSB0aGlzLnRvdWNobW92ZUg7XG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgdGhpcy50b3VjaGVuZEgpO1xuICAgIGRlbGV0ZSB0aGlzLnRvdWNoZW5kSDtcbiAgICB0aGlzLmVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMubW91c2Vkb3duSCk7XG4gICAgZGVsZXRlIHRoaXMubW91c2Vkb3duSDtcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgdGhpcy5tb3VzZW1vdmVIKTtcbiAgICBkZWxldGUgdGhpcy5tb3VzZW1vdmVIO1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgdGhpcy5tb3VzZXVwSCk7XG4gICAgZGVsZXRlIHRoaXMubW91c2V1cEg7XG4gICAgdGhpcy5mb3J3YXJkZS5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuZm9yd2FyZEgpO1xuICAgIGRlbGV0ZSB0aGlzLmZvcndhcmRIO1xuICAgIHRoaXMuYmFja2UucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmJhY2tIKTtcbiAgICBkZWxldGUgdGhpcy5iYWNrSDtcbiAgICB0aGlzLmVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5jbGlja0gpO1xuICAgIGRlbGV0ZSB0aGlzLmNsaWNrSDtcbiAgICB0aGlzLmNvbnRhaW5lci5yZW1vdmVFdmVudExpc3RlbmVyKCdmb2N1cycsIHRoaXMuX2ZvY3VzSGFuZGxlciwgdHJ1ZSk7XG4gICAgZGVsZXRlIHRoaXMuX2ZvY3VzSGFuZGxlcjtcbiAgICBpZiAodGhpcy5wYXVzZUVsKSB7XG4gICAgICB0aGlzLnBhdXNlRWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLnBhdXNlSCk7XG4gICAgICBkZWxldGUgdGhpcy5wYXVzZUg7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBFdmVudCBoYW5kbGVyIGZvciB0aGUgc3BhcmsudmlzaWJsZS1jaGlsZHJlbiBldmVudCwganVzdCBjYWxsIHRoZSBjaGFuZ2UgZnVuY3Rpb24gdG8gaGFuZGxlIGFueVxuICAgKiB2aXNpYmlsaXR5IG9yIHNpemluZyBjaGFuZ2VzXG4gICAqIEBwYXJhbSB7RXZlbnR9IGUgVGhlIHNwYXJrLnZpc2libGUtY2hpbGRyZW4gZXZlbnRcbiAgICovXG5cblxuICBDYXJvdXNlbC5wcm90b3R5cGUuX2hhbmRsZVZpc2libGVDaGlsZHJlbkggPSBmdW5jdGlvbiBfaGFuZGxlVmlzaWJsZUNoaWxkcmVuSChlKSB7XG4gICAgaWYgKGUudGFyZ2V0LmNvbnRhaW5zKHRoaXMuZWwpKSB7XG4gICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuY2hhbmdlKCk7XG4gICAgICB9LmJpbmQodGhpcyksIDApO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogRm9yd2FyZCBidXR0b24gY2xpY2sgaGFuZGxlciB0cmlnZ2VycyBhIHNjcm9sbFRvIHRvIHRoZSBcIm5leHRcIiBlbGVtZW50XG4gICAqIEBwYXJhbSB7RXZlbnR9IGUgVGhlIGNsaWNrIGV2ZW50XG4gICAqL1xuXG5cbiAgQ2Fyb3VzZWwucHJvdG90eXBlLl9mb3J3YXJkID0gZnVuY3Rpb24gX2ZvcndhcmQoZSkge1xuICAgIHZhciBzID0gdGhpcy5pdGVtcy5pbmRleE9mKHRoaXMuX3NlbGVjdGVkSXRlbSgpKTtcbiAgICBzKys7XG4gICAgaWYgKHMgPiB0aGlzLml0ZW1zLmxlbmd0aCAtIDEpIHtcbiAgICAgIGlmICh0aGlzLm9wdHMud3JhcEl0ZW1zKSB7XG4gICAgICAgIHMgPSAwO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcy0tO1xuICAgICAgfVxuICAgIH1cbiAgICBkZWxldGUgdGhpcy5tb3ZlcztcbiAgICB2YXIgYSA9IHRoaXMuX3N0YXJ0aW5nVmVsb2NpdHk7XG4gICAgYSA9IGEgPCAtdGhpcy5vcHRzLnN0YXJ0aW5nVmVsb2NpdHkgPyBhIDogLXRoaXMub3B0cy5zdGFydGluZ1ZlbG9jaXR5O1xuICAgIHRoaXMuX3JhZkNhbmNlbCgpO1xuICAgIHRoaXMuX3Njcm9sbFRvSXRlbSA9IHRydWU7XG4gICAgdGhpcy5fc2Nyb2xsVG8odGhpcy5pdGVtc1tzXSwgYSk7XG4gICAgaWYgKGUpIHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIEJhY2sgYnV0dG9uIGNsaWNrIGhhbmRsZXIgdHJpZ2dlcnMgYSBzY3JvbGxUbyB0byB0aGUgXCJwcmV2aW91c1wiIGVsZW1lbnRcbiAgICogQHBhcmFtIHtFdmVudH0gZSBUaGUgY2xpY2sgZXZlbnRcbiAgICovXG5cblxuICBDYXJvdXNlbC5wcm90b3R5cGUuX2JhY2sgPSBmdW5jdGlvbiBfYmFjayhlKSB7XG4gICAgdmFyIHMgPSB0aGlzLml0ZW1zLmluZGV4T2YodGhpcy5fc2VsZWN0ZWRJdGVtKCkpO1xuICAgIHMtLTtcbiAgICBpZiAocyA8IDApIHtcbiAgICAgIGlmICh0aGlzLm9wdHMud3JhcEl0ZW1zKSB7XG4gICAgICAgIHMgPSB0aGlzLml0ZW1zLmxlbmd0aCAtIDE7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzKys7XG4gICAgICB9XG4gICAgfVxuICAgIGRlbGV0ZSB0aGlzLm1vdmVzO1xuICAgIHZhciBhID0gdGhpcy5fc3RhcnRpbmdWZWxvY2l0eTtcbiAgICBhID0gYSA+IHRoaXMub3B0cy5zdGFydGluZ1ZlbG9jaXR5ID8gYSA6IHRoaXMub3B0cy5zdGFydGluZ1ZlbG9jaXR5O1xuICAgIHRoaXMuX3JhZkNhbmNlbCgpO1xuICAgIHRoaXMuX3Njcm9sbFRvSXRlbSA9IHRydWU7XG4gICAgdGhpcy5fc2Nyb2xsVG8odGhpcy5pdGVtc1tzXSwgYSk7XG4gICAgaWYgKGUpIHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIE1vdmUgc3RhcnQgaGFuZGxlciwgaGFuZGxlcyBib3RoIHRvdWNoc3RhcnQgYW5kIG1vdXNlZG93biBldmVudHNcbiAgICogQHBhcmFtIHtPYmplY3R9IGUgVGhlIHN0YXJ0IGV2ZW50XG4gICAqL1xuXG5cbiAgQ2Fyb3VzZWwucHJvdG90eXBlLl9tb3Zlc3RhcnQgPSBmdW5jdGlvbiBfbW92ZXN0YXJ0KGUpIHtcbiAgICB0aGlzLl9yYWZDYW5jZWwoKTtcbiAgICB0aGlzLm1vdmVzID0gW107XG4gICAgdGhpcy5tb3Zlcy5wdXNoKGUpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBNb3ZlIGhhbmRsZXIsIGhhbmRsZXMgaW50ZXJuYWwgbW92ZSBldmVudCBvYmplY3RzXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBlIFRoZSBtb3ZlIGV2ZW50XG4gICAqL1xuXG5cbiAgQ2Fyb3VzZWwucHJvdG90eXBlLl9tb3ZlID0gZnVuY3Rpb24gX21vdmUoZSkge1xuICAgIGlmICh0aGlzLm1vdmVzICYmIHRoaXMubW92ZXMubGVuZ3RoID4gMSkge1xuICAgICAgdGhpcy5fYWRkVHJhbnNmb3JtKGUucGFnZVggLSB0aGlzLm1vdmVzW3RoaXMubW92ZXMubGVuZ3RoIC0gMV0ucGFnZVgpO1xuICAgICAgdGhpcy5tb3Zlcy5wdXNoKGUpO1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCA9IHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmICh0aGlzLm1vdmVzICYmIHRoaXMubW92ZXNbMF0pIHtcbiAgICAgICAgaWYgKE1hdGguYWJzKHRoaXMubW92ZXNbMF0ucGFnZVggLSBlLnBhZ2VYKSA+IE1hdGguYWJzKHRoaXMubW92ZXNbMF0ucGFnZVkgLSBlLnBhZ2VZKSAmJiBNYXRoLmFicyh0aGlzLm1vdmVzWzBdLnBhZ2VYIC0gZS5wYWdlWCkgPiA1ICYmIGUuY2FuY2VsYWJsZSkge1xuICAgICAgICAgIHRoaXMuX2FkZFRyYW5zZm9ybShlLnBhZ2VYIC0gdGhpcy5tb3Zlc1swXS5wYWdlWCk7XG4gICAgICAgICAgdGhpcy5tb3Zlcy5wdXNoKGUpO1xuICAgICAgICAgIGUucHJldmVudERlZmF1bHQgPSB0cnVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChNYXRoLmFicyh0aGlzLm1vdmVzWzBdLnBhZ2VYIC0gZS5wYWdlWCkgPiA1KSB7XG4gICAgICAgICAgICB0aGlzLm1vdmVzWzBdID0gZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChlLnR5cGUgPT09ICd0b3VjaGVuZCcgfHwgZS50eXBlID09PSAnbW91c2V1cCcpIHtcbiAgICAgICAgZGVsZXRlIHRoaXMubW92ZXM7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBNb3ZlIGVuZCBoYW5kbGVyLCBoYW5kbGVzIGJvdGggdG91Y2hlbmQgYW5kIG1vdXNldXAgZXZlbnRzXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBlIFRoZSBtb3ZlZW5kIGV2ZW50XG4gICAqL1xuXG5cbiAgQ2Fyb3VzZWwucHJvdG90eXBlLl9tb3ZlZW5kID0gZnVuY3Rpb24gX21vdmVlbmQoZSkge1xuICAgIHRoaXMuX21vdmUoZSk7XG4gICAgaWYgKCF0aGlzLm9wdHMuc21vb3RoU2Nyb2xsKSB7XG4gICAgICB0aGlzLl9zZXR0bGUodGhpcy5tb3Zlcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2ludGVyaWFTY3JvbGwodGhpcy5tb3Zlcyk7XG4gICAgfVxuICAgIHJldHVybiBlO1xuICB9O1xuXG4gIC8qKlxuICAgKiBSZXNpemUgZXZlbnQgaGFuZGxlciwgY2FsbHMgY2hhbmdlIHRvIGhhbmRsZSBhbnkgZWxlbWVudCBkaW1lbnNpb24gY2hhbmdlc1xuICAgKi9cblxuXG4gIENhcm91c2VsLnByb3RvdHlwZS5fcmVzaXplID0gZnVuY3Rpb24gX3Jlc2l6ZSgpIHtcbiAgICB0aGlzLmNoYW5nZSgpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBDYWxsaW5nIHRoZSBjaGFuZ2UgZnVuY3Rpb24gd2lsbCBoYW5kbGUgdXBkYXRpbmcgdGhlIGVsZW1lbnQgdG8gdGFrZSBpbnRvIGFjY291bnRcbiAgICogYW55IHN0eWxpbmcsIHNpemluZywgb3IgdmlzaWJpbGl0eSBjaGFuZ2VzLCBhbmQgdGhlIGFkZGl0aW9uIG9yIHJlbW92YWwgb2YgYW55IGNhcm91c2VsSXRlbXNcbiAgICovXG5cblxuICBDYXJvdXNlbC5wcm90b3R5cGUuY2hhbmdlID0gZnVuY3Rpb24gY2hhbmdlKCkge1xuICAgIHZhciBkaW1zID0gdGhpcy5lbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICBpZiAoZGltcy53aWR0aCAhPT0gdGhpcy53aWR0aCB8fCBkaW1zLmhlaWdodCAhPT0gdGhpcy5oZWlnaHQpIHtcbiAgICAgIGlmICh0aGlzLmF1dG9BZHZhbmNlKSB7XG4gICAgICAgIHdpbmRvdy5jbGVhclRpbWVvdXQodGhpcy5hdXRvQWR2YW5jZSk7XG4gICAgICAgIGRlbGV0ZSB0aGlzLmF1dG9BZHZhbmNlO1xuICAgICAgfVxuICAgICAgdGhpcy5fcmFmQ2FuY2VsKCk7XG4gICAgICB2YXIgYyA9IHRoaXMuX3NlbGVjdGVkSXRlbSgpO1xuICAgICAgdGhpcy5fc2V0VHJhbnNmb3JtKDApO1xuICAgICAgdGhpcy5fc2V0VHJhbnNmb3JtSXRlbXMoMCk7XG4gICAgICB0aGlzLl9pbml0KHRoaXMuZWwpO1xuICAgICAgaWYgKHRoaXMuaXRlbXMuaW5kZXhPZihjLmVsLnNwYXJrY2Fyb3VzZWxpdGVtKSA+IC0xICYmIHRoaXMudG90YWxJdGVtV2lkdGggPiB0aGlzLndpZHRoKSB7XG4gICAgICAgIGlmICh0aGlzLm9wdHMud3JhcEl0ZW1zKSB7XG4gICAgICAgICAgdGhpcy5fYWRkVHJhbnNmb3JtKC10aGlzLnRvdGFsSXRlbVdpZHRoICsgKC1jLmVsLnNwYXJrY2Fyb3VzZWxpdGVtLmN1cnJlbnRQb3NpdGlvbigpICsgdGhpcy53aWR0aCAvIDIpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLl9hZGRUcmFuc2Zvcm0oLWMuZWwuc3BhcmtjYXJvdXNlbGl0ZW0uY3VycmVudFBvc2l0aW9uKCkgKyB0aGlzLndpZHRoIC8gMik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSB0aGUgY29tcG9uZW50IHRvIHVzZSBhIG5ldyBlbGVtZW50IG9yIHJlcGFyc2UgZnJvbVxuICAgKiB0aGUgZXhpc3RpbmcgZWxlbWVudC5cbiAgICogQHBhcmFtIHtFbGVtZW50fSBlbCBPcHRpb25hbFxuICAgKi9cblxuXG4gIENhcm91c2VsLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiB1cGRhdGUoZWwpIHtcblxuICAgIGVsID0gZWwgfHwgdGhpcy5lbDtcblxuICAgIHRoaXMuX3JlbW92ZUxpc3RlbmVycygpO1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdyZXNpemUnLCB0aGlzLnJlc2l6ZUgpO1xuICAgIGRlbGV0ZSB0aGlzLnJlc2l6ZUg7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignc3BhcmsudmlzaWJsZS1jaGlsZHJlbicsIHRoaXMuX2hhbmRsZVZpc2libGVDaGlsZHJlbiwgdHJ1ZSk7XG4gICAgZGVsZXRlIHRoaXMuX2hhbmRsZVZpc2libGVDaGlsZHJlbjtcbiAgICB0aGlzLl9pbml0KGVsKTtcblxuICAgIHRoaXMuY2hhbmdlKCk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAvKipcbiAgICogVG91Y2hzdGFydCBldmVudCBoYW5kbGVyLCBwYXNzZXMgbmVjZXNzYXJ5IGRhdGEgcG9pbnRzIHRvIHRoZSBtb3Zlc3RhcnQgZnVuY3Rpb25cbiAgICogQHBhcmFtIHtPYmplY3R9IGUgVGhlIHRvdWNoc3RhcnQgZXZlbnRcbiAgICovXG5cblxuICBDYXJvdXNlbC5wcm90b3R5cGUuX3RvdWNoc3RhcnQgPSBmdW5jdGlvbiBfdG91Y2hzdGFydChlKSB7XG4gICAgdmFyIGEgPSB7XG4gICAgICAndHlwZSc6IGUudHlwZSxcbiAgICAgICdwYWdlWCc6IGUudG91Y2hlc1swXS5wYWdlWCxcbiAgICAgICdwYWdlWSc6IGUudG91Y2hlc1swXS5wYWdlWSxcbiAgICAgICd0aW1lU3RhbXAnOiBlLnRpbWVTdGFtcFxuICAgIH07XG4gICAgdGhpcy5fbW92ZXN0YXJ0KGEpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBUb3VjaG1vdmUgZXZlbnQgaGFuZGxlciwgcGFzc2VzIG5lY2Vzc2FyeSBkYXRhIHBvaW50cyB0byB0aGUgbW92ZSBmdW5jdGlvblxuICAgKiBAcGFyYW0ge09iamVjdH0gZSBUaGUgdG91Y2htb3ZlIGV2ZW50XG4gICAqL1xuXG5cbiAgQ2Fyb3VzZWwucHJvdG90eXBlLl90b3VjaG1vdmUgPSBmdW5jdGlvbiBfdG91Y2htb3ZlKGUpIHtcbiAgICB2YXIgYSA9IHtcbiAgICAgICd0eXBlJzogZS50eXBlLFxuICAgICAgJ3BhZ2VYJzogZS50b3VjaGVzWzBdLnBhZ2VYLFxuICAgICAgJ3BhZ2VZJzogZS50b3VjaGVzWzBdLnBhZ2VZLFxuICAgICAgJ3RpbWVTdGFtcCc6IGUudGltZVN0YW1wLFxuICAgICAgJ2NhbmNlbGFibGUnOiBlLmNhbmNlbGFibGVcbiAgICB9O1xuICAgIHRoaXMuX21vdmUoYSk7XG4gICAgaWYgKGEucHJldmVudERlZmF1bHQpIHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIFRvdWNoZW5kIGV2ZW50IGhhbmRsZXIsIHBhc3NlcyBuZWNlc3NhcnkgZGF0YSBwb2ludHMgdG8gdGhlIG1vdmVlbmQgZnVuY3Rpb25cbiAgICogQHBhcmFtIHtPYmplY3R9IGUgVGhlIHRvdWNoZW5kIGV2ZW50XG4gICAqL1xuXG5cbiAgQ2Fyb3VzZWwucHJvdG90eXBlLl90b3VjaGVuZCA9IGZ1bmN0aW9uIF90b3VjaGVuZChlKSB7XG4gICAgaWYgKHRoaXMubW92ZXMgJiYgdGhpcy5tb3Zlcy5sZW5ndGggPiAyICYmIGUuY2FuY2VsYWJsZSkge1xuICAgICAgdmFyIGEgPSB7XG4gICAgICAgICd0eXBlJzogZS50eXBlLFxuICAgICAgICAncGFnZVgnOiB0aGlzLm1vdmVzW3RoaXMubW92ZXMubGVuZ3RoIC0gMV0ucGFnZVgsXG4gICAgICAgICdwYWdlWSc6IHRoaXMubW92ZXNbdGhpcy5tb3Zlcy5sZW5ndGggLSAxXS5wYWdlWSxcbiAgICAgICAgJ3RpbWVTdGFtcCc6IGUudGltZVN0YW1wXG4gICAgICB9O1xuICAgICAgdGhpcy5fbW92ZWVuZChhKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZGVsZXRlIHRoaXMubW92ZXM7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBNb3VzZWRvd24gZXZlbnQgaGFuZGxlciwgcGFzc2VzIG5lY2Vzc2FyeSBkYXRhIHBvaW50cyB0byB0aGUgbW92ZXN0YXJ0IGZ1bmN0aW9uXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBlIFRoZSBtb3VzZWRvd24gZXZlbnRcbiAgICovXG5cblxuICBDYXJvdXNlbC5wcm90b3R5cGUuX21vdXNlZG93biA9IGZ1bmN0aW9uIF9tb3VzZWRvd24oZSkge1xuICAgIGlmIChlLmJ1dHRvbiAhPT0gMCkge1xuICAgICAgcmV0dXJuIGU7XG4gICAgfVxuICAgIHRoaXMuaXNNb3VzZURvd24gPSB0cnVlO1xuICAgIHZhciBhID0ge1xuICAgICAgJ3R5cGUnOiBlLnR5cGUsXG4gICAgICAncGFnZVgnOiBlLnBhZ2VYLFxuICAgICAgJ3BhZ2VZJzogZS5wYWdlWSxcbiAgICAgICd0aW1lU3RhbXAnOiBlLnRpbWVTdGFtcFxuICAgIH07XG4gICAgdGhpcy5fbW92ZXN0YXJ0KGEpO1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgfTtcblxuICAvKipcbiAgICogTW91c2Vtb3ZlIGV2ZW50IGhhbmRsZXIsIHBhc3NlcyBuZWNlc3NhcnkgZGF0YSBwb2ludHMgdG8gdGhlIG1vdmUgZnVuY3Rpb25cbiAgICogQHBhcmFtIHtPYmplY3R9IGUgVGhlIG1vdXNlbW92ZSBldmVudFxuICAgKi9cblxuXG4gIENhcm91c2VsLnByb3RvdHlwZS5fbW91c2Vtb3ZlID0gZnVuY3Rpb24gX21vdXNlbW92ZShlKSB7XG4gICAgaWYgKHRoaXMuaXNNb3VzZURvd24pIHtcbiAgICAgIHZhciBhID0ge1xuICAgICAgICAndHlwZSc6IGUudHlwZSxcbiAgICAgICAgJ3BhZ2VYJzogZS5jbGllbnRYLFxuICAgICAgICAncGFnZVknOiBlLmNsaWVudFksXG4gICAgICAgICd0aW1lU3RhbXAnOiBlLnRpbWVTdGFtcCxcbiAgICAgICAgLy90aGlzIHdhcyBjaGFuZ2VkIHRvIGNvcnJlY3QgYW4gaXNzdWUgaW4gc2FmYXJpIC0gaXQgZG9lc24ndCByZXBvcnQgY2FuY2VsYWJsZSBjb3JyZWN0bHlcbiAgICAgICAgJ2NhbmNlbGFibGUnOiB0cnVlXG4gICAgICB9O1xuICAgICAgdGhpcy5fbW92ZShhKTtcbiAgICAgIGlmIChhLnByZXZlbnREZWZhdWx0KSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIE1vdXNldXAgZXZlbnQgaGFuZGxlciwgcGFzc2VzIG5lY2Vzc2FyeSBkYXRhIHBvaW50cyB0byB0aGUgbW92ZWVuZCBmdW5jdGlvblxuICAgKiBAcGFyYW0ge09iamVjdH0gZSBUaGUgbW91c2V1cCBldmVudFxuICAgKi9cblxuXG4gIENhcm91c2VsLnByb3RvdHlwZS5fbW91c2V1cCA9IGZ1bmN0aW9uIF9tb3VzZXVwKGUpIHtcbiAgICBpZiAodGhpcy5tb3ZlcyAmJiB0aGlzLm1vdmVzLmxlbmd0aCA+IDIpIHtcbiAgICAgIHZhciBhID0ge1xuICAgICAgICAndHlwZSc6IGUudHlwZSxcbiAgICAgICAgJ3BhZ2VYJzogZS5wYWdlWCxcbiAgICAgICAgJ3BhZ2VZJzogZS5wYWdlWSxcbiAgICAgICAgJ3RpbWVTdGFtcCc6IGUudGltZVN0YW1wXG4gICAgICB9O1xuICAgICAgdGhpcy5fbW92ZWVuZChhKTtcbiAgICAgIHRoaXMubW91c2VVcEhhbmRsZWQgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICBkZWxldGUgdGhpcy5tb3ZlcztcbiAgICAgIHRoaXMuX3Njcm9sbFRvQ2xpY2tlZChlKTtcbiAgICB9XG4gICAgdGhpcy5pc01vdXNlRG93biA9IGZhbHNlO1xuICB9O1xuXG4gIC8qKlxuICAgKiBDbGljayBldmVudCBoYW5kbGVyXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBlIFRoZSBjbGljayBldmVudFxuICAgKi9cblxuXG4gIENhcm91c2VsLnByb3RvdHlwZS5fY2xpY2sgPSBmdW5jdGlvbiBfY2xpY2soZSkge1xuICAgIC8vaWYgd2UgYXJlIGFscmVhZHkgdHJhY2tpbmcgbW92ZXMsIHRoZW4gdGhpcyB3aWxsIGJlIGhhbmRsZWQgYnkgdGhlIG1vdXNlZW5kIGV2ZW50IGhhbmRsZXIgYW5kIHdlIHNob3VsZCBwcmV2ZW50IHRoZSBkZWZhdWx0IGFjdGlvblxuICAgIGlmICh0aGlzLm1vdmVzKSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuICAgIC8vaWYgaXQgaGFzIGFscmVhZHkgYmVlbiBoYW5kbGVkIGJ5IG1vdXNldXAgaGFuZGxlciwgcHJldmVudCB0aGUgYWN0aW9uXG4gICAgaWYgKHRoaXMubW91c2VVcEhhbmRsZWQpIHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG4gICAgLy9yZXNldCBvdXIgaGFuZGxlZCBzdGF0ZVxuICAgIGRlbGV0ZSB0aGlzLm1vdXNlVXBIYW5kbGVkO1xuICAgIC8vY2hlY2tpbmcgYm90aCB0aGlzLm1vdmVzIGFuZCB0aGlzLm1vdXNlVXBIYW5kbGVkIGVuc3VyZXMgd2UgY2FwdHVyZSBldmVudHMgY29ycmVjdGx5IGluIGFsbCBicm93c2Vycywgd2hlcmUgdGhlIG9yZGVyIG9mIHRoZSBtb3VzZXVwL2NsaWNrIGV2ZW50cyBjYW4gdmFyeVxuICB9O1xuXG4gIC8qKlxuICAgKiBDYWxjdWxhdGUgdGhlIHVzZXIncyByZWNlbnQgY3Vyc29yL2ZpbmdlciB2ZWxvY2l0eVxuICAgKiBAcGFyYW0ge0FycmF5fSBtb3ZlcyBUaGUgYXJyYXkgb2YgY3Vyc29yIHBvc2l0aW9uc1xuICAgKi9cblxuXG4gIENhcm91c2VsLnByb3RvdHlwZS5fdmVsb2NpdHkgPSBmdW5jdGlvbiBfdmVsb2NpdHkobW92ZXMpIHtcbiAgICB2YXIgYXZnID0gMDtcbiAgICB2YXIgbSA9IE1hdGgubWluKDYsIG1vdmVzLmxlbmd0aCAtIDEpO1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDwgbTsgaSsrKSB7XG4gICAgICBpZiAobW92ZXNbbW92ZXMubGVuZ3RoIC0gaV0udGltZVN0YW1wID09PSBtb3Zlc1ttb3Zlcy5sZW5ndGggLSBpIC0gMV0udGltZVN0YW1wKSB7XG4gICAgICAgIGF2ZyArPSBhdmcgLyBpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYXZnICs9IDEwICogKG1vdmVzW21vdmVzLmxlbmd0aCAtIGldLnBhZ2VYIC0gbW92ZXNbbW92ZXMubGVuZ3RoIC0gaSAtIDFdLnBhZ2VYKSAvIChtb3Zlc1ttb3Zlcy5sZW5ndGggLSBpXS50aW1lU3RhbXAgLSBtb3Zlc1ttb3Zlcy5sZW5ndGggLSBpIC0gMV0udGltZVN0YW1wKSAvIG07XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBhdmc7XG4gIH07XG5cbiAgLyoqXG4gICAqIEhhbmRsZXMgY2xpY2sgZXZlbnRzIG9uIGl0ZW1zIGFuZCBkb3RzLCBzY3JvbGxpbmcgdG8gdGhlIGNsaWNrZWQgaXRlbVxuICAgKiBAcGFyYW0ge0V2ZW50fSBlIFRoZSBjbGljayBldmVudFxuICAgKi9cblxuXG4gIENhcm91c2VsLnByb3RvdHlwZS5fc2Nyb2xsVG9DbGlja2VkID0gZnVuY3Rpb24gX3Njcm9sbFRvQ2xpY2tlZChlKSB7XG4gICAgdmFyIHRhciA9IGUudGFyZ2V0O1xuICAgIGlmICh0aGlzLmVsLmNvbnRhaW5zKHRhcikpIHtcbiAgICAgIHdoaWxlICghdGFyLnNwYXJrY2Fyb3VzZWwpIHtcbiAgICAgICAgaWYgKHRhci5zcGFya2Nhcm91c2VsaXRlbSkge1xuICAgICAgICAgIHRoaXMuY29udGFpbmVyTWFzay5zY3JvbGxMZWZ0ID0gMDtcbiAgICAgICAgICBkZWxldGUgdGhpcy5tb3ZlcztcbiAgICAgICAgICB0aGlzLl9yYWZDYW5jZWwoKTtcbiAgICAgICAgICB0aGlzLl9zY3JvbGxUbyh0YXIuc3BhcmtjYXJvdXNlbGl0ZW0pO1xuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBpZiAodGFyLnNwYXJrY2Fyb3VzZWxpdGVtZG90KSB7XG4gICAgICAgICAgdGhpcy5jb250YWluZXJNYXNrLnNjcm9sbExlZnQgPSAwO1xuICAgICAgICAgIGRlbGV0ZSB0aGlzLm1vdmVzO1xuICAgICAgICAgIHRoaXMuX3JhZkNhbmNlbCgpO1xuICAgICAgICAgIHZhciB2ID0gdGFyLnNwYXJrY2Fyb3VzZWxpdGVtZG90Lm9yZGVyIDwgdGhpcy5fc2VsZWN0ZWRJdGVtKCkub3JkZXIgPyB0aGlzLm9wdHMuc3RhcnRpbmdWZWxvY2l0eSA6IC10aGlzLm9wdHMuc3RhcnRpbmdWZWxvY2l0eTtcbiAgICAgICAgICB0aGlzLl9zY3JvbGxUbyh0YXIuc3BhcmtjYXJvdXNlbGl0ZW1kb3QsIHYpO1xuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICB0YXIgPSB0YXIucGFyZW50Tm9kZTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIFNjcm9sbCB0byB0aGUgY2Fyb3VzZWxJdGVtLCB3aXRoIHNwZWNpZmllZCBzdGFydGluZ1ZlbG9jaXR5LCBhdXRvIGRldGVybWluZXMgZGVmYXVsdCB2ZWxvY2l0eSBpZiBub3Qgc3BlY2lmaWVkXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBpdGVtIFRoZSBjYXJvdXNlbEl0ZW0gdG8gc2Nyb2xsIHRvXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBzdGFydGluZ1ZlbG9jaXR5IFRoZSBzdGFydGluZ1ZlbG9jaXR5IG9mIHRoZSBzY3JvbGwgYW5pbWF0aW9uXG4gICAqL1xuXG5cbiAgQ2Fyb3VzZWwucHJvdG90eXBlLl9zY3JvbGxUbyA9IGZ1bmN0aW9uIF9zY3JvbGxUbyhpdGVtLCBzdGFydGluZ1ZlbG9jaXR5KSB7XG4gICAgdmFyIG9mZnNldCA9IHRoaXMud2lkdGggLyAyO1xuICAgIHZhciBjdXJyZW50UG9zaXRpb24gPSBpdGVtLmN1cnJlbnRQb3NpdGlvbigpO1xuICAgIGlmICghc3RhcnRpbmdWZWxvY2l0eSkge1xuICAgICAgc3RhcnRpbmdWZWxvY2l0eSA9IG9mZnNldCAtIGl0ZW0uY3VycmVudFBvc2l0aW9uKCkgPiAwID8gdGhpcy5vcHRzLnN0YXJ0aW5nVmVsb2NpdHkgOiAtdGhpcy5vcHRzLnN0YXJ0aW5nVmVsb2NpdHk7XG4gICAgfVxuICAgIGlmICh0aGlzLm9wdHMud3JhcEl0ZW1zKSB7XG4gICAgICBpZiAoc3RhcnRpbmdWZWxvY2l0eSA+IDApIHtcbiAgICAgICAgLy9sZWZ0XG4gICAgICAgIGlmIChjdXJyZW50UG9zaXRpb24gPiBvZmZzZXQpIHtcbiAgICAgICAgICB0aGlzLl90b3RhbERpc3RhbmNlID0gb2Zmc2V0ICsgdGhpcy50b3RhbEl0ZW1XaWR0aCAtIGN1cnJlbnRQb3NpdGlvbjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLl90b3RhbERpc3RhbmNlID0gb2Zmc2V0IC0gY3VycmVudFBvc2l0aW9uO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvL3JpZ2h0XG4gICAgICAgIGlmIChjdXJyZW50UG9zaXRpb24gPCBvZmZzZXQpIHtcbiAgICAgICAgICB0aGlzLl90b3RhbERpc3RhbmNlID0gLSh0aGlzLnRvdGFsSXRlbVdpZHRoICsgY3VycmVudFBvc2l0aW9uIC0gb2Zmc2V0KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLl90b3RhbERpc3RhbmNlID0gb2Zmc2V0IC0gY3VycmVudFBvc2l0aW9uO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3RvdGFsRGlzdGFuY2UgPSBvZmZzZXQgLSBjdXJyZW50UG9zaXRpb247XG4gICAgfVxuICAgIHRoaXMuX3N0YXJ0aW5nVmVsb2NpdHkgPSBzdGFydGluZ1ZlbG9jaXR5O1xuICAgIGRlbGV0ZSB0aGlzLm1vdmVzO1xuICAgIHRoaXMuX3Njcm9sbFRvSXRlbSA9IHRydWU7XG4gICAgdGhpcy5fcmFmID0gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLl9yYWZIYW5kbGVyKTtcbiAgfTtcblxuICAvKipcbiAgICogVGhpcyBpcyB0aGUgYW5pbWF0b3IgZnVuY3Rpb24sIGl0IGV4YW1pbmVzIHRoZSBvcHRpb25zIHNldCBvbiB0aGUgY2Fyb3VzZWwgb2JqZWN0XG4gICAqIGFuZCBzZWxlY3RpdmVseSBhZGRzIHRyYW5zZm9ybSBhbmQgcmVxdWVzdHMgYWRkdGlvbmFsIGFuaW1hdGlvbiBmcmFtZXMgaWYgbmVjZXNhcnlcbiAgICogQHBhcmFtIHtOdW1iZXJ9IHQgVGhlIHRpbWVzdGFtcCBmb3IgdGhlIGN1cnJlbnQgYW5pbWF0aW9uIGZyYW1lXG4gICAqL1xuXG5cbiAgQ2Fyb3VzZWwucHJvdG90eXBlLl9yYWZIYW5kbGVySCA9IGZ1bmN0aW9uIF9yYWZIYW5kbGVySCh0KSB7XG4gICAgaWYgKHRoaXMub3B0cy5hdXRvQWR2YW5jZSAmJiB0aGlzLmF1dG9BZHZhbmNlKSB7XG4gICAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KHRoaXMuYXV0b0FkdmFuY2UpO1xuICAgICAgZGVsZXRlIHRoaXMuYXV0b0FkdmFuY2U7XG4gICAgfVxuICAgIHZhciBmcmFtZXM7XG4gICAgaWYgKHRoaXMubW92ZXMgfHwgIXRoaXMuX3N0YXJ0aW5nVmVsb2NpdHkpIHtcbiAgICAgIHRoaXMuX3JhZkNhbmNlbCgpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoIXRoaXMuX2xhc3RzdGFydCkge1xuICAgICAgdGhpcy5fbGFzdHN0YXJ0ID0gdDtcbiAgICB9XG4gICAgaWYgKCF0aGlzLl9yZW1haW5pbmdEaXN0YW5jZSkge1xuICAgICAgdGhpcy5fcmVtYWluaW5nRGlzdGFuY2UgPSB0aGlzLl90b3RhbERpc3RhbmNlO1xuICAgIH1cbiAgICBpZiAoIXRoaXMuX2xhc3RmcmFtZSkge1xuICAgICAgdGhpcy5fbGFzdGZyYW1lID0gdDtcbiAgICAgIGZyYW1lcyA9IDE7XG4gICAgfSBlbHNlIHtcbiAgICAgIGZyYW1lcyA9ICh0IC0gdGhpcy5fbGFzdGZyYW1lKSAvICgxIC8gNjAgKiAxMDAwKTtcbiAgICB9XG4gICAgdmFyIGQgPSB0aGlzLl9zdGFydGluZ1ZlbG9jaXR5ICogZnJhbWVzO1xuICAgIGlmICh0aGlzLm9wdHMuc21vb3RoU2Nyb2xsICYmICF0aGlzLl9zY3JvbGxUb0l0ZW0pIHtcbiAgICAgIHRoaXMuX2FkZFRyYW5zZm9ybShkKTtcbiAgICAgIHRoaXMuX3N0YXJ0aW5nVmVsb2NpdHkgKj0gTWF0aC5wb3coMC45NywgZnJhbWVzKTtcbiAgICAgIGlmICh0aGlzLm9wdHMuc21vb3RoU2Nyb2xsQ2VudGVySXRlbXMgJiYgTWF0aC5hYnModGhpcy5fc3RhcnRpbmdWZWxvY2l0eSkgPCAxKSB7XG4gICAgICAgIHRoaXMuX3Njcm9sbFRvKHRoaXMuX3NlbGVjdGVkSXRlbSgpKTtcbiAgICAgIH1cbiAgICAgIGlmIChNYXRoLmFicyh0aGlzLl9zdGFydGluZ1ZlbG9jaXR5KSA8IDAuNSkge1xuICAgICAgICBpZiAodGhpcy5fc3RhcnRpbmdWZWxvY2l0eSA+IDAgJiYgdGhpcy50cmFuc2Zvcm0ueCA+IHRoaXMudG90YWxJdGVtV2lkdGggLyAyIC0gdGhpcy5pdGVtc1swXS53aWR0aCAvIDIgfHwgdGhpcy5fc3RhcnRpbmdWZWxvY2l0eSA8IDAgJiYgdGhpcy50cmFuc2Zvcm0ueCA8IC0odGhpcy50b3RhbEl0ZW1XaWR0aCAvIDIgLSB0aGlzLml0ZW1zW3RoaXMuaXRlbXMubGVuZ3RoIC0gMV0ud2lkdGggLyAyKSkge1xuICAgICAgICAgIHRoaXMuX3Njcm9sbFRvSXRlbSA9IHRydWU7XG4gICAgICAgICAgdGhpcy5fc2Nyb2xsVG8odGhpcy5fc2VsZWN0ZWRJdGVtKCkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuX3JhZkNhbmNlbCgpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLl9yYWYgPSB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMuX3JhZkhhbmRsZXIpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAodGhpcy5fc3RhcnRpbmdWZWxvY2l0eSA+IDApIHtcbiAgICAgICAgaWYgKGQgPCB0aGlzLl9yZW1haW5pbmdEaXN0YW5jZSkge1xuICAgICAgICAgIHRoaXMuX2FkZFRyYW5zZm9ybShkKTtcbiAgICAgICAgICB0aGlzLl9yZW1haW5pbmdEaXN0YW5jZSAtPSBkO1xuICAgICAgICAgIGlmICh0aGlzLl9yZW1haW5pbmdEaXN0YW5jZSA+IHRoaXMuX3RvdGFsRGlzdGFuY2UgLyAyKSB7XG4gICAgICAgICAgICB0aGlzLl9zdGFydGluZ1ZlbG9jaXR5ICo9IE1hdGgucG93KDEuMTUsIGZyYW1lcyk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX3N0YXJ0aW5nVmVsb2NpdHkgKj0gTWF0aC5wb3coMC45LCBmcmFtZXMpO1xuICAgICAgICAgICAgdGhpcy5fc3RhcnRpbmdWZWxvY2l0eSA9IHRoaXMuX3N0YXJ0aW5nVmVsb2NpdHkgPiAyID8gdGhpcy5fc3RhcnRpbmdWZWxvY2l0eSA6IDI7XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMuX3JhZiA9IHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5fcmFmSGFuZGxlcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5fYWRkVHJhbnNmb3JtKHRoaXMuX3JlbWFpbmluZ0Rpc3RhbmNlKTtcbiAgICAgICAgICB0aGlzLl9yYWZDYW5jZWwoKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKGQgPiB0aGlzLl9yZW1haW5pbmdEaXN0YW5jZSkge1xuICAgICAgICAgIHRoaXMuX2FkZFRyYW5zZm9ybShkKTtcbiAgICAgICAgICB0aGlzLl9yZW1haW5pbmdEaXN0YW5jZSAtPSBkO1xuICAgICAgICAgIGlmICh0aGlzLl9yZW1haW5pbmdEaXN0YW5jZSA8IHRoaXMuX3RvdGFsRGlzdGFuY2UgLyAyKSB7XG4gICAgICAgICAgICB0aGlzLl9zdGFydGluZ1ZlbG9jaXR5ICo9IE1hdGgucG93KDEuMTUsIGZyYW1lcyk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX3N0YXJ0aW5nVmVsb2NpdHkgKj0gTWF0aC5wb3coMC45LCBmcmFtZXMpO1xuICAgICAgICAgICAgdGhpcy5fc3RhcnRpbmdWZWxvY2l0eSA9IHRoaXMuX3N0YXJ0aW5nVmVsb2NpdHkgPCAtMiA/IHRoaXMuX3N0YXJ0aW5nVmVsb2NpdHkgOiAtMjtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5fcmFmID0gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLl9yYWZIYW5kbGVyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLl9hZGRUcmFuc2Zvcm0odGhpcy5fcmVtYWluaW5nRGlzdGFuY2UpO1xuICAgICAgICAgIHRoaXMuX3JhZkNhbmNlbCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMuX2xhc3RmcmFtZSA9IHQ7XG4gIH07XG5cbiAgLyoqXG4gICAqIFRoaXMgaXMgdGhlIGFuaW1hdG9yIGNsZWFyaW5nIGZ1bmN0aW9uXG4gICAqIGl0IGNsZWFycyB2YWx1ZXMgdXNlZCBkdXJpbmcgYW5pbWF0aW9uLCBhbmQgc2VsZWN0aXZlbHkgZW5hYmxlcyBhdXRvQWR2YW5jZVxuICAgKi9cblxuXG4gIENhcm91c2VsLnByb3RvdHlwZS5fcmFmQ2FuY2VsID0gZnVuY3Rpb24gX3JhZkNhbmNlbCgpIHtcbiAgICBpZiAodGhpcy5vcHRzLmF1dG9BZHZhbmNlICYmICF0aGlzLmF1dG9BZHZhbmNlICYmICF0aGlzLnBhdXNlKSB7XG4gICAgICB0aGlzLmF1dG9BZHZhbmNlID0gd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9hdXRvQWR2YW5jZSgpO1xuICAgICAgfS5iaW5kKHRoaXMpLCB0aGlzLm9wdHMuYXV0b0FkdmFuY2UgKiAxMDAwKTtcbiAgICB9XG4gICAgd2luZG93LmNhbmNlbEFuaW1hdGlvbkZyYW1lKHRoaXMuX3JhZik7XG4gICAgZGVsZXRlIHRoaXMuX3Njcm9sbFRvSXRlbTtcbiAgICBkZWxldGUgdGhpcy5fbGFzdHN0YXJ0O1xuICAgIGRlbGV0ZSB0aGlzLl9zdGFydGluZ1ZlbG9jaXR5O1xuICAgIGRlbGV0ZSB0aGlzLl9yZW1haW5pbmdEaXN0YW5jZTtcbiAgICBkZWxldGUgdGhpcy5fdG90YWxEaXN0YW5jZTtcbiAgICBkZWxldGUgdGhpcy5fbGFzdGZyYW1lO1xuICB9O1xuXG4gIC8qKlxuICAgKiBUaGlzIGNvbXB1dGVzIHZhbHVlcyBuZWNlc3NhcnkgdG8gc3RhcnQgYW4gYW5pbWF0aW9uIGZyYW1lIHdoZW4gdGhlIGNhcm91c2VsIGlzXG4gICAqIGNvbmZpZ3VyZWQgdG8gdXNlIHNtb290aFNjcm9sbFxuICAgKiBAcGFyYW0ge0FycmF5fSBtb3ZlcyBUaGUgY2FwdHVyZWQgbW92ZSBldmVudHNcbiAgICovXG5cblxuICBDYXJvdXNlbC5wcm90b3R5cGUuX2ludGVyaWFTY3JvbGwgPSBmdW5jdGlvbiBfaW50ZXJpYVNjcm9sbChtb3Zlcykge1xuICAgIGlmIChtb3Zlc1ttb3Zlcy5sZW5ndGggLSAxXS50aW1lU3RhbXAgLSBtb3Zlc1ttb3Zlcy5sZW5ndGggLSAyXS50aW1lU3RhbXAgPiAxMDAgfHwgbW92ZXMubGVuZ3RoIDwgMykge1xuICAgICAgaWYgKHRoaXMub3B0cy5zbW9vdGhTY3JvbGxDZW50ZXJJdGVtcykge1xuICAgICAgICByZXR1cm4gdGhpcy5fc2Nyb2xsVG8odGhpcy5fc2VsZWN0ZWRJdGVtKCkpO1xuICAgICAgfVxuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLl9zdGFydGluZ1ZlbG9jaXR5ID0gdGhpcy5fdmVsb2NpdHkobW92ZXMpO1xuICAgIGRlbGV0ZSB0aGlzLm1vdmVzO1xuICAgIHRoaXMuX3JhZiA9IHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5fcmFmSGFuZGxlcik7XG4gIH07XG5cbiAgLyoqXG4gICAqIFRoaXMgZGV0ZXJtaW5lcyB3aGljaCBjYXJvdXNlbCBpdGVtIHNob3VsZCBiZSBmb2N1c2VkIGJhc2VkIG9uIHRoZSBwcmV2aW91cyBtb3Zlc1xuICAgKiBtYWRlIGJ5IHRoZSB1c2VyXG4gICAqIEBwYXJhbSB7QXJyYXl9IG1vdmVzIFRoZSBjYXB0dXJlZCBtb3ZlIGV2ZW50c1xuICAgKi9cblxuXG4gIENhcm91c2VsLnByb3RvdHlwZS5fc2V0dGxlID0gZnVuY3Rpb24gX3NldHRsZShtb3Zlcykge1xuICAgIGlmIChtb3ZlcyAmJiBtb3Zlcy5sZW5ndGggPiAzKSB7XG4gICAgICBpZiAobW92ZXNbbW92ZXMubGVuZ3RoIC0gMV0udGltZVN0YW1wIC0gbW92ZXNbbW92ZXMubGVuZ3RoIC0gMl0udGltZVN0YW1wID4gODApIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Njcm9sbFRvKHRoaXMuX3NlbGVjdGVkSXRlbSgpKTtcbiAgICAgIH1cbiAgICAgIHZhciB2MSA9IDEwICogKG1vdmVzW21vdmVzLmxlbmd0aCAtIDNdLnBhZ2VYIC0gbW92ZXNbbW92ZXMubGVuZ3RoIC0gNF0ucGFnZVgpIC8gKG1vdmVzW21vdmVzLmxlbmd0aCAtIDNdLnRpbWVTdGFtcCAtIG1vdmVzW21vdmVzLmxlbmd0aCAtIDRdLnRpbWVTdGFtcCk7XG4gICAgICB2YXIgdjIgPSAxMCAqIChtb3Zlc1ttb3Zlcy5sZW5ndGggLSAyXS5wYWdlWCAtIG1vdmVzW21vdmVzLmxlbmd0aCAtIDNdLnBhZ2VYKSAvIChtb3Zlc1ttb3Zlcy5sZW5ndGggLSAyXS50aW1lU3RhbXAgLSBtb3Zlc1ttb3Zlcy5sZW5ndGggLSAzXS50aW1lU3RhbXApO1xuICAgICAgaWYgKE1hdGguYWJzKHYxKSA8IE1hdGguYWJzKHYyKSB8fCBNYXRoLmFicyh2MikgPiAwLjUgJiYgTWF0aC5hYnModjIpID4gMC41KSB7XG4gICAgICAgIC8vdXNlciBpcyBwcm9iYWJseSB0cnlpbmcgdG8gZ28gdG8gbmV4dCBvciBwcmV2IGl0ZW1cbiAgICAgICAgdmFyIHMgPSB0aGlzLml0ZW1zLmluZGV4T2YodGhpcy5fc2VsZWN0ZWRJdGVtKCkpO1xuICAgICAgICBpZiAodjIgPiAwKSB7XG4gICAgICAgICAgLy9wcmV2XG4gICAgICAgICAgaWYgKHMgPiAwKSB7XG4gICAgICAgICAgICB0aGlzLl9zY3JvbGxUbyh0aGlzLml0ZW1zW3MgLSAxXSwgdjIpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAodGhpcy5vcHRzLndyYXBJdGVtcykge1xuICAgICAgICAgICAgICB0aGlzLl9zY3JvbGxUbyh0aGlzLml0ZW1zW3RoaXMuaXRlbXMubGVuZ3RoIC0gMV0sIHYyKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHRoaXMuX3Njcm9sbFRvKHRoaXMuaXRlbXNbMF0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvL25leHRcbiAgICAgICAgICBpZiAocyA8IHRoaXMuaXRlbXMubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgdGhpcy5fc2Nyb2xsVG8odGhpcy5pdGVtc1tzICsgMV0sIHYyKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKHRoaXMub3B0cy53cmFwSXRlbXMpIHtcbiAgICAgICAgICAgICAgdGhpcy5fc2Nyb2xsVG8odGhpcy5pdGVtc1swXSwgdjIpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGhpcy5fc2Nyb2xsVG8odGhpcy5pdGVtc1t0aGlzLml0ZW1zLmxlbmd0aCAtIDFdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICh0aGlzLl9zZWxlY3RlZEl0ZW0oKS5jdXJyZW50UG9zaXRpb24oKSA+IHRoaXMud2lkdGggLyAyKSB7XG4gICAgICAgICAgdGhpcy5fc2Nyb2xsVG8odGhpcy5fc2VsZWN0ZWRJdGVtKCksIC10aGlzLm9wdHMuc3RhcnRpbmdWZWxvY2l0eSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5fc2Nyb2xsVG8odGhpcy5fc2VsZWN0ZWRJdGVtKCksIHRoaXMub3B0cy5zdGFydGluZ1ZlbG9jaXR5KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogVHJhbnNmb3JtcyB0aGUgcG9zaXRpb24gb2YgYWxsIGNhcm91c2VsSXRlbXNcbiAgICogQHBhcmFtIHtOdW1iZXJ9IHggVGhlIHBpeGVsIHZhbHVlIHRvIHRyYW5zZm9ybVxuICAgKi9cblxuXG4gIENhcm91c2VsLnByb3RvdHlwZS5fdHJhbnNmb3JtSXRlbXMgPSBmdW5jdGlvbiBfdHJhbnNmb3JtSXRlbXMoeCkge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5pdGVtcy5sZW5ndGg7IGkrKykge1xuICAgICAgdGhpcy5pdGVtc1tpXS5hZGRUcmFuc2Zvcm0oeCk7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBTZXRzIHRoZSB0cmFuc2Zvcm0gcG9zaXRpb24gb2YgYWxsIGNhcm91c2VsSXRlbXNcbiAgICogQHBhcmFtIHtOdW1iZXJ9IHggVGhlIHBpeGVsIHZhbHVlIHRvIHRyYW5zZm9ybVxuICAgKi9cblxuXG4gIENhcm91c2VsLnByb3RvdHlwZS5fc2V0VHJhbnNmb3JtSXRlbXMgPSBmdW5jdGlvbiBfc2V0VHJhbnNmb3JtSXRlbXMoeCkge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5pdGVtcy5sZW5ndGg7IGkrKykge1xuICAgICAgdGhpcy5pdGVtc1tpXS5zZXRUcmFuc2Zvcm0oeCk7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBBZGRzIHRyYW5zZm9ybSB0byB0aGUgY29udGFpbmVyIGVsZW1lbnQsIGRvZXMgY2hlY2tpbmcgZm9yIGJvdW5kcyBjb25kaXRpb25zIGFuZFxuICAgKiB3cmFwcyBpdGVtcyBpZiBuZWNlc3NhcnkgYW5kIGNvbmZpZ3VyZWRcbiAgICogQHBhcmFtIHtOdW1iZXJ9IHggVGhlIHBpeGVsIHZhbHVlIHRvIHRyYW5zZm9ybVxuICAgKi9cblxuXG4gIENhcm91c2VsLnByb3RvdHlwZS5fYWRkVHJhbnNmb3JtID0gZnVuY3Rpb24gX2FkZFRyYW5zZm9ybSh4KSB7XG4gICAgdmFyIGE7XG4gICAgaWYgKCh0aGlzLm9wdHMuc21vb3RoU2Nyb2xsQ2VudGVySXRlbXMgfHwgIXRoaXMub3B0cy5zbW9vdGhTY3JvbGwpICYmICF0aGlzLm9wdHMud3JhcEl0ZW1zICYmICF0aGlzLm9wdHMuZWRnZVNjcm9sbCkge1xuICAgICAgdmFyIGwgPSB0aGlzLml0ZW1zLmluZGV4T2YodGhpcy5zZWxlY3RlZEl0ZW0pO1xuICAgICAgaWYgKGwgPT09IHRoaXMuaXRlbXMubGVuZ3RoIC0gMSkge1xuICAgICAgICB0aGlzLl9sZWZ0Ym91bmQodHJ1ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLl9sZWZ0Ym91bmQoZmFsc2UpO1xuICAgICAgfVxuICAgICAgaWYgKGwgPT09IDApIHtcbiAgICAgICAgdGhpcy5fcmlnaHRib3VuZCh0cnVlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX3JpZ2h0Ym91bmQoZmFsc2UpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9sZWZ0Ym91bmQoZmFsc2UpO1xuICAgICAgdGhpcy5fcmlnaHRib3VuZChmYWxzZSk7XG4gICAgfVxuICAgIGlmICh0aGlzLnRyYW5zZm9ybS54ICsgeCA8IDAgJiYgeCA8IDApIHtcbiAgICAgIGlmICh0aGlzLm9wdHMud3JhcEl0ZW1zKSB7XG4gICAgICAgIC8vd3JhcCBpdGVtcyB1bnRpbCB3ZSBoYXZlIGNvdmVyZWQgdGhlIHZpc2libGUgYXJlYVxuICAgICAgICB3aGlsZSAodGhpcy50cmFuc2Zvcm0ueCArIHggPCAtKHRoaXMudG90YWxJdGVtV2lkdGggLSB0aGlzLndpZHRoKSAvIDIgJiYgKHRoaXMudG90YWxJdGVtV2lkdGggPCB0aGlzLndpZHRoID8gdGhpcy50cmFuc2Zvcm0ueCArIHggPCAtdGhpcy50b3RhbEl0ZW1XaWR0aCAvIDIgOiB0cnVlKSkge1xuICAgICAgICAgIGEgPSB0aGlzLml0ZW1zLnNoaWZ0KCk7XG4gICAgICAgICAgdGhpcy5pdGVtcy5wdXNoKGEpO1xuICAgICAgICAgIGEuYWRkVHJhbnNmb3JtKHRoaXMudG90YWxJdGVtV2lkdGgpO1xuICAgICAgICAgIHRoaXMuX3RyYW5zZm9ybUl0ZW1zKC1hLndpZHRoKTtcbiAgICAgICAgICB4ICs9IGEud2lkdGg7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vdGhlcmUgaXMgYSAxIHBpeGVsIGFkanVzdG1lbnQgdG8gYWNjb3VudCBmb3Igc29tZSBtYXRoIHJvdW5kaW5nXG4gICAgICAgIGlmICh0aGlzLm9wdHMuZWRnZVNjcm9sbCAmJiB4IDwgMCAmJiB0aGlzLnRyYW5zZm9ybS54ICsgeCAtIDEgPD0gLSh0aGlzLnRvdGFsSXRlbVdpZHRoIC0gdGhpcy53aWR0aCkgLyAyKSB7XG4gICAgICAgICAgdGhpcy5fbGVmdGJvdW5kKHRydWUpO1xuICAgICAgICAgIHJldHVybiB0aGlzLl9zZXRUcmFuc2Zvcm0oLSh0aGlzLnRvdGFsSXRlbVdpZHRoIC0gdGhpcy53aWR0aCkgLyAyKTtcbiAgICAgICAgfVxuICAgICAgICAvL3Byb2dyZXNzaXZlbHkgcmVkdWNlIHNjcm9sbGluZyB3aGVuIG5vIG1vcmUgaXRlbXMgdG8gdGhlIHJpZ2h0XG4gICAgICAgIGlmICh4IDwgMCAmJiB0aGlzLnRyYW5zZm9ybS54ICsgeCA8IC0odGhpcy50b3RhbEl0ZW1XaWR0aCAvIDIgLSB0aGlzLml0ZW1zW3RoaXMuaXRlbXMubGVuZ3RoIC0gMV0ud2lkdGggLyAyKSkge1xuICAgICAgICAgIHggPSB4ICogKCh0aGlzLnRvdGFsSXRlbVdpZHRoIC8gMiArIHRoaXMuaXRlbXNbdGhpcy5pdGVtcy5sZW5ndGggLSAxXS53aWR0aCAvIDIgKyAodGhpcy50cmFuc2Zvcm0ueCArIHgpKSAvIHRoaXMuaXRlbXNbdGhpcy5pdGVtcy5sZW5ndGggLSAxXS53aWR0aCk7XG4gICAgICAgICAgeCA9IHggPiAwID8gMCA6IHg7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzLl9zZXRUcmFuc2Zvcm0odGhpcy50cmFuc2Zvcm0ueCArIHgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAodGhpcy50cmFuc2Zvcm0ueCArIHggPiAwICYmIHggPiAwKSB7XG4gICAgICAgIGlmICh0aGlzLm9wdHMud3JhcEl0ZW1zKSB7XG4gICAgICAgICAgLy93cmFwIGl0ZW1zIHVudGlsIHdlIGhhdmUgY292ZXJlZCB0aGUgdmlzaWJsZSBhcmVhXG4gICAgICAgICAgd2hpbGUgKHRoaXMudHJhbnNmb3JtLnggKyB4ID4gLSh0aGlzLndpZHRoIC0gdGhpcy50b3RhbEl0ZW1XaWR0aCkgLyAyICYmICh0aGlzLnRvdGFsSXRlbVdpZHRoIDwgdGhpcy53aWR0aCA/IHRoaXMudHJhbnNmb3JtLnggKyB4ID4gdGhpcy50b3RhbEl0ZW1XaWR0aCAvIDIgOiB0cnVlKSkge1xuICAgICAgICAgICAgYSA9IHRoaXMuaXRlbXMucG9wKCk7XG4gICAgICAgICAgICB0aGlzLml0ZW1zLnVuc2hpZnQoYSk7XG4gICAgICAgICAgICBhLmFkZFRyYW5zZm9ybSgtdGhpcy50b3RhbEl0ZW1XaWR0aCk7XG4gICAgICAgICAgICB0aGlzLl90cmFuc2Zvcm1JdGVtcyhhLndpZHRoKTtcbiAgICAgICAgICAgIHggLT0gYS53aWR0aDtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy90aGVyZSBpcyBhIDEgcGl4ZWwgYWRqdXN0bWVudCB0byBhY2NvdW50IGZvciBzb21lIG1hdGggcm91bmRpbmdcbiAgICAgICAgICBpZiAodGhpcy5vcHRzLmVkZ2VTY3JvbGwgJiYgeCA+IDAgJiYgdGhpcy50cmFuc2Zvcm0ueCArIHggKyAxID49ICh0aGlzLnRvdGFsSXRlbVdpZHRoIC0gdGhpcy53aWR0aCkgLyAyKSB7XG4gICAgICAgICAgICB0aGlzLl9yaWdodGJvdW5kKHRydWUpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3NldFRyYW5zZm9ybSgodGhpcy50b3RhbEl0ZW1XaWR0aCAtIHRoaXMud2lkdGgpIC8gMik7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8vcHJvZ3Jlc3NpdmVseSByZWR1Y2Ugc2Nyb2xsaW5nIHdoZW4gbm8gbW9yZSBpdGVtcyB0byB0aGUgbGVmdFxuICAgICAgICAgIGlmICh4ID4gMCAmJiB0aGlzLnRyYW5zZm9ybS54ICsgeCA+IHRoaXMudG90YWxJdGVtV2lkdGggLyAyIC0gdGhpcy5pdGVtc1swXS53aWR0aCAvIDIpIHtcbiAgICAgICAgICAgIHggPSB4ICogKCh0aGlzLnRvdGFsSXRlbVdpZHRoIC8gMiArIHRoaXMuaXRlbXNbMF0ud2lkdGggLyAyIC0gKHRoaXMudHJhbnNmb3JtLnggKyB4KSkgLyB0aGlzLml0ZW1zWzBdLndpZHRoKTtcbiAgICAgICAgICAgIHggPSB4IDwgMCA/IDAgOiB4O1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMuX3NldFRyYW5zZm9ybSh0aGlzLnRyYW5zZm9ybS54ICsgeCk7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBTZXRzIHRoZSBsZWZ0Ym91bmQgY2xhc3NcbiAgICogQHBhcmFtIHtCb29sZWFufSBiIFNldCBvciB1bnNldCB0aGUgbGVmdGJvdW5kIGNsYXNzXG4gICAqL1xuXG5cbiAgQ2Fyb3VzZWwucHJvdG90eXBlLl9sZWZ0Ym91bmQgPSBmdW5jdGlvbiBfbGVmdGJvdW5kKGIpIHtcbiAgICBpZiAodHlwZW9mIGIgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICB0aGlzLmxlZnRib3VuZCA9IHR5cGVvZiB0aGlzLmxlZnRib3VuZCA9PT0gJ3VuZGVmaW5lZCcgPyBmYWxzZSA6IHRoaXMubGVmdGJvdW5kO1xuICAgICAgcmV0dXJuIHRoaXMubGVmdGJvdW5kO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoYikge1xuICAgICAgICAoMCwgX2FkZENsYXNzMi5kZWZhdWx0KSh0aGlzLmVsLCAnbGVmdGJvdW5kJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAoMCwgX3JlbW92ZUNsYXNzMi5kZWZhdWx0KSh0aGlzLmVsLCAnbGVmdGJvdW5kJyk7XG4gICAgICB9XG4gICAgICB0aGlzLmxlZnRib3VuZCA9IGI7XG4gICAgICByZXR1cm4gdGhpcy5sZWZ0Ym91bmQ7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBTZXRzIHRoZSByaWdodGJvdW5kIGNsYXNzXG4gICAqIEBwYXJhbSB7Qm9vbGVhbn0gYiBTZXQgb3IgdW5zZXQgdGhlIHJpZ2h0Ym91bmQgY2xhc3NcbiAgICovXG5cblxuICBDYXJvdXNlbC5wcm90b3R5cGUuX3JpZ2h0Ym91bmQgPSBmdW5jdGlvbiBfcmlnaHRib3VuZChiKSB7XG4gICAgaWYgKHR5cGVvZiBiID09PSAndW5kZWZpbmVkJykge1xuICAgICAgdGhpcy5yaWdodGJvdW5kID0gdHlwZW9mIHRoaXMucmlnaHRib3VuZCA9PT0gJ3VuZGVmaW5lZCcgPyBmYWxzZSA6IHRoaXMucmlnaHRib3VuZDtcbiAgICAgIHJldHVybiB0aGlzLnJpZ2h0Ym91bmQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChiKSB7XG4gICAgICAgICgwLCBfYWRkQ2xhc3MyLmRlZmF1bHQpKHRoaXMuZWwsICdyaWdodGJvdW5kJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAoMCwgX3JlbW92ZUNsYXNzMi5kZWZhdWx0KSh0aGlzLmVsLCAncmlnaHRib3VuZCcpO1xuICAgICAgfVxuICAgICAgdGhpcy5yaWdodGJvdW5kID0gYjtcbiAgICAgIHJldHVybiB0aGlzLnJpZ2h0Ym91bmQ7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSBzZWxlY3RlZCBpdGVtLCBieSBzZWVpbmcgd2hpY2ggaXRlbSBoYXMgaXRzIGNlbnRlciBjbG9zZXN0XG4gICAqIHRvIHRoZSBjZW50ZXIgb2YgdGhlIGNhcm91c2VsXG4gICAqL1xuXG5cbiAgQ2Fyb3VzZWwucHJvdG90eXBlLl91cGRhdGVTZWxlY3RlZCA9IGZ1bmN0aW9uIF91cGRhdGVTZWxlY3RlZCgpIHtcbiAgICB2YXIgdGFyID0gdGhpcy53aWR0aCAvIDI7XG4gICAgdmFyIGkgPSAtMTtcbiAgICB2YXIgYSA9IDE7XG4gICAgdmFyIGIgPSAwO1xuICAgIHdoaWxlIChhID4gYikge1xuICAgICAgaSsrO1xuICAgICAgaWYgKGkgPiB0aGlzLml0ZW1zLmxlbmd0aCAtIDIpIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBhID0gTWF0aC5hYnModGFyIC0gdGhpcy5pdGVtc1tpXS5jdXJyZW50UG9zaXRpb24oKSk7XG4gICAgICBiID0gTWF0aC5hYnModGFyIC0gdGhpcy5pdGVtc1tpICsgMV0uY3VycmVudFBvc2l0aW9uKCkpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5fc2VsZWN0ZWRJdGVtKHRoaXMuaXRlbXNbaV0pO1xuICB9O1xuXG4gIC8qKlxuICAgKiBTdG9yZXMgdGhlIHNlbGVjdGVkIGl0ZW0gZm9yIHRoZSBjYXJvdXNlbCwgYW5kIHVwZGF0ZXMgdGhlIHByZXZpb3VzbHlcbiAgICogc2VsZWN0ZWQgaXRlbSBhbmQgbmV3bHkgc2VsZWN0ZWQgaXRlbSB0byBoYXZlIHRoZSBjb3JyZWN0IHN0YXRlc1xuICAgKiBDb25kaXRpb25hbGx5IHNldHMgdGhlIGxlZnRib3VuZC9yaWdodGJvdW5kIHN0YXRlcyBkZXBlbmRpbmcgb24gY29uZmlndXJhdGlvblxuICAgKiBAcGFyYW0ge09iamVjdH0gaXRlbSBPcHRpb25hbDogdGhlIG5ldyBpdGVtIHNlbGVjdCwgaWYgb21pdHRlZCBpdCB3aWxsXG4gICAqIHJldHVybiB0aGUgY3VycmVudGx5IHNlbGVjdGVkIGl0ZW0uXG4gICAqL1xuXG5cbiAgQ2Fyb3VzZWwucHJvdG90eXBlLl9zZWxlY3RlZEl0ZW0gPSBmdW5jdGlvbiBfc2VsZWN0ZWRJdGVtKGl0ZW0pIHtcbiAgICBpZiAoKHR5cGVvZiBpdGVtID09PSAndW5kZWZpbmVkJyA/ICd1bmRlZmluZWQnIDogX3R5cGVvZihpdGVtKSkgIT09ICdvYmplY3QnKSB7XG4gICAgICBpZiAodGhpcy5zZWxlY3RlZEl0ZW0pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VsZWN0ZWRJdGVtO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3VwZGF0ZVNlbGVjdGVkKCk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmICh0aGlzLnNlbGVjdGVkSXRlbSkge1xuICAgICAgICB0aGlzLnNlbGVjdGVkSXRlbS5zZXRTZWxlY3RlZChmYWxzZSk7XG4gICAgICB9XG4gICAgICB0aGlzLnNlbGVjdGVkSXRlbSA9IGl0ZW07XG4gICAgICBpZiAoKHRoaXMub3B0cy5zbW9vdGhTY3JvbGxDZW50ZXJJdGVtcyB8fCAhdGhpcy5vcHRzLnNtb290aFNjcm9sbCkgJiYgIXRoaXMub3B0cy53cmFwSXRlbXMgJiYgIXRoaXMub3B0cy5lZGdlU2Nyb2xsKSB7XG4gICAgICAgIHZhciBsID0gdGhpcy5pdGVtcy5pbmRleE9mKHRoaXMuc2VsZWN0ZWRJdGVtKTtcbiAgICAgICAgaWYgKGwgPT09IHRoaXMuaXRlbXMubGVuZ3RoIC0gMSkge1xuICAgICAgICAgIHRoaXMuX2xlZnRib3VuZCh0cnVlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLl9sZWZ0Ym91bmQoZmFsc2UpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChsID09PSAwKSB7XG4gICAgICAgICAgdGhpcy5fcmlnaHRib3VuZCh0cnVlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLl9yaWdodGJvdW5kKGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdGhpcy5zZWxlY3RlZEl0ZW0uc2V0U2VsZWN0ZWQodHJ1ZSk7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBTZXRzIHRoZSB0cmFuc2Zvcm0gZm9yIHRoZSBjYXJvdXNlbCBjb250YWluZXJcbiAgICogQHBhcmFtIHtOdW1iZXJ9IHggVGhlIHBpeGVsIHZhbHVlIHRvIHRyYW5zZm9ybVxuICAgKi9cblxuXG4gIENhcm91c2VsLnByb3RvdHlwZS5fc2V0VHJhbnNmb3JtID0gZnVuY3Rpb24gX3NldFRyYW5zZm9ybSh4KSB7XG4gICAgeCA9IHggPyB4IDogMDtcbiAgICB0aGlzLnRyYW5zZm9ybSA9IHtcbiAgICAgICd4JzogeFxuICAgIH07XG4gICAgdGhpcy5jb250YWluZXIuc2V0QXR0cmlidXRlKCdzdHlsZScsICgwLCBfdHJhbnNmb3JtMi5kZWZhdWx0KSgndHJhbnNsYXRlM2QnLCB4ICsgJ3B4LCAwcHgsIDBweCcpKTtcbiAgICB0aGlzLl91cGRhdGVTZWxlY3RlZCgpO1xuICAgIHJldHVybiB4O1xuICB9O1xuXG4gIHJldHVybiBDYXJvdXNlbDtcbn0oX2Jhc2UyLmRlZmF1bHQpO1xuXG4vKipcbiAqIERlZmF1bHQgdmFsdWVzIGZvciBpbnRlcm5hbCBwcm9wZXJ0aWVzIHdlIHdpbGwgYmUgc2V0dGluZy5cbiAqIFRoZXNlIGFyZSBzZXQgb24gZWFjaCBjb25zdHJ1Y3Rpb24gc28gd2UgZG9uJ3QgbGVhayBwcm9wZXJ0aWVzXG4gKiBpbnRvIHRoZSBwcm90b3R5cGUgY2hhaW4uXG4gKiBAdHlwZSB7T2JqZWN0fVxuICovXG5cblxuQ2Fyb3VzZWwucHJvdG90eXBlLmRlZmF1bHRzID0ge1xuICBlbDogbnVsbFxufTtcblxuLyoqXG4gKiBXaGl0ZWxpc3RlZCBwYXJhbWV0ZXJzIHdoaWNoIGNhbiBiZSBzZXQgb24gY29uc3RydWN0aW9uLlxuICogQHR5cGUge0FycmF5fVxuICovXG5DYXJvdXNlbC5wcm90b3R5cGUuX3doaXRlbGlzdGVkUGFyYW1zID0gW107XG5cbmV4cG9ydHMuZGVmYXVsdCA9IENhcm91c2VsO1xubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG4vLyMgc291cmNlTWFwcGluZ1VSTD1jYXJvdXNlbC5qcy5tYXBcbiIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF90eXBlb2YgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gXCJzeW1ib2xcIiA/IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH0gOiBmdW5jdGlvbiAob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqOyB9OyAvKipcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICMgVHJhbnNmb3JtXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBBcHBseSBhIGNyb3NzLWJyb3dzZXIgdHJhbnNmb3JtIHN0eWxlLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBleGFtcGxlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiB0cmFuc2Zvcm0oJ3RyYW5zbGF0ZVgnLCAnLTEwMHB4Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IHR5cGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSB2YWxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAbW9kdWxlIGhlbHBlcnMvY3NzL3RyYW5zZm9ybS5qc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbnZhciBfZWFjaCA9IHJlcXVpcmUoJy4uL3V0aWwvZWFjaCcpO1xuXG52YXIgX2VhY2gyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZWFjaCk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbnZhciBwcmVmaXhlcyA9IFsnLXdlYmtpdC0nLCAnLW1vei0nLCAnLW8tJywgJy1tcy0nLCAnJ107XG5cbmZ1bmN0aW9uIHRyYW5zZm9ybSh0eXBlLCB2YWwpIHtcblxuICB2YXIgc3RyID0gJyc7XG5cbiAgKDAsIF9lYWNoMi5kZWZhdWx0KShwcmVmaXhlcywgZnVuY3Rpb24gKHApIHtcblxuICAgIGlmICgodHlwZW9mIHZhbCA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2YodmFsKSkgPT09ICdvYmplY3QnKSB7XG4gICAgICBzdHIgKz0gcCArICd0cmFuc2Zvcm06ICc7XG5cbiAgICAgIGZvciAodmFyIGogaW4gdmFsKSB7XG4gICAgICAgIHN0ciArPSBqICsgJygnICsgdmFsW2pdICsgJyk7ICc7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHN0ciArPSBwICsgJ3RyYW5zZm9ybTogJyArIHR5cGUgKyAnKCcgKyB2YWwgKyAnKTsgJztcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBzdHI7XG59XG5cbmV4cG9ydHMuZGVmYXVsdCA9IHRyYW5zZm9ybTtcbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dHJhbnNmb3JtLmpzLm1hcFxuIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX3RyaW0gPSByZXF1aXJlKCcuLi91dGlsL3RyaW0nKTtcblxudmFyIF90cmltMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3RyaW0pO1xuXG52YXIgX2hhc0NsYXNzID0gcmVxdWlyZSgnLi9oYXMtY2xhc3MnKTtcblxudmFyIF9oYXNDbGFzczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9oYXNDbGFzcyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbi8qKlxuICogIyBBZGQgQ2xhc3NcbiAqIEFkZCBhIGNsYXNzIG9uIGFuIGVsZW1lbnQuXG4gKlxuICogQHBhcmFtIHtFbGVtZW50fEFycmF5fSBlbCBBbiBlbGVtZW50IG9yIGFycmF5IG9mIGVsZW1lbnRzIHRvIHVwZGF0ZS5cbiAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lXG4gKiBAcmV0dXJuIHtFbGVtZW50fVxuICpcbiAqIEBtb2R1bGUgaGVscGVycy9kb20vYWRkLWNsYXNzLmpzXG4gKi9cblxudmFyIHdzID0gL1xccysvO1xudmFyIGNsZWFudXAgPSAvXFxzezIsfS9nO1xuXG5mdW5jdGlvbiBhZGRDbGFzcyhlbCwgbmFtZSkge1xuXG4gIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAyICYmIHR5cGVvZiBuYW1lID09PSAnc3RyaW5nJykge1xuICAgIG5hbWUgPSAoMCwgX3RyaW0yLmRlZmF1bHQpKG5hbWUpLnNwbGl0KHdzKTtcbiAgfSBlbHNlIHtcbiAgICBuYW1lID0gbmFtZSBpbnN0YW5jZW9mIEFycmF5ID8gbmFtZSA6IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7XG4gIH1cblxuICAvLyBvcHRpbWl6ZSBmb3IgYmVzdCwgbW9zdCBjb21tb24gY2FzZVxuICBpZiAobmFtZS5sZW5ndGggPT09IDEgJiYgZWwuY2xhc3NMaXN0KSB7XG4gICAgaWYgKG5hbWVbMF0pIHtcbiAgICAgIGVsLmNsYXNzTGlzdC5hZGQobmFtZVswXSk7XG4gICAgfVxuICAgIHJldHVybiBlbDtcbiAgfVxuXG4gIHZhciB0b0FkZCA9IFtdO1xuICB2YXIgaSA9IDA7XG4gIHZhciBsID0gbmFtZS5sZW5ndGg7XG4gIHZhciBpdGVtID0gdm9pZCAwO1xuICB2YXIgY2xzTmFtZSA9IHR5cGVvZiBlbC5jbGFzc05hbWUgPT09ICdzdHJpbmcnID8gZWwuY2xhc3NOYW1lIDogZWwuZ2V0QXR0cmlidXRlID8gZWwuZ2V0QXR0cmlidXRlKCdjbGFzcycpIDogJyc7XG5cbiAgLy8gc2VlIGlmIHdlIGhhdmUgYW55dGhpbmcgdG8gYWRkXG4gIGZvciAoOyBpIDwgbDsgaSsrKSB7XG4gICAgaXRlbSA9IG5hbWVbaV07XG4gICAgaWYgKGl0ZW0gJiYgISgwLCBfaGFzQ2xhc3MyLmRlZmF1bHQpKGNsc05hbWUsIGl0ZW0pKSB7XG4gICAgICB0b0FkZC5wdXNoKGl0ZW0pO1xuICAgIH1cbiAgfVxuXG4gIGlmICh0b0FkZC5sZW5ndGgpIHtcbiAgICBpZiAodHlwZW9mIGVsLmNsYXNzTmFtZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGVsLmNsYXNzTmFtZSA9ICgwLCBfdHJpbTIuZGVmYXVsdCkoKGNsc05hbWUgKyAnICcgKyB0b0FkZC5qb2luKCcgJykpLnJlcGxhY2UoY2xlYW51cCwgJyAnKSk7XG4gICAgfSBlbHNlIGlmIChlbC5zZXRBdHRyaWJ1dGUpIHtcbiAgICAgIGVsLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAoMCwgX3RyaW0yLmRlZmF1bHQpKChjbHNOYW1lICsgJyAnICsgdG9BZGQuam9pbignICcpKS5yZXBsYWNlKGNsZWFudXAsICcgJykpKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gZWw7XG59XG5cbmV4cG9ydHMuZGVmYXVsdCA9IGFkZENsYXNzO1xubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hZGQtY2xhc3MuanMubWFwXG4iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfdHlwZW9mID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09IFwic3ltYm9sXCIgPyBmdW5jdGlvbiAob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9IDogZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyBcInN5bWJvbFwiIDogdHlwZW9mIG9iajsgfTtcblxuLyoqXG4gKiAjIEhhcyBDbGFzc1xuICogU2VlIGlmIGFuIGVsZW1lbnQgaGFzIGEgY2xhc3MuXG4gKlxuICogQHBhcmFtIHtFbGVtZW50fFN0cmluZ30gZWxcbiAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lXG4gKiBAcmV0dXJuIHtCb29sZWFufVxuICpcbiAqIEBtb2R1bGUgaGVscGVycy9kb20vaGFzLWNsYXNzLmpzXG4gKi9cbmZ1bmN0aW9uIGhhc0NsYXNzKGVsLCBuYW1lKSB7XG4gIHZhciBjTmFtZSA9ICgodHlwZW9mIGVsID09PSAndW5kZWZpbmVkJyA/ICd1bmRlZmluZWQnIDogX3R5cGVvZihlbCkpID09PSAnb2JqZWN0JyA/IGVsLmNsYXNzTmFtZSB8fCBlbC5nZXRBdHRyaWJ1dGUgJiYgZWwuZ2V0QXR0cmlidXRlKCdjbGFzcycpIHx8ICcnIDogZWwgfHwgJycpLnJlcGxhY2UoL1tcXHRcXHJcXG5cXGZdL2csICcgJyk7XG4gIHJldHVybiAoJyAnICsgY05hbWUgKyAnICcpLmluZGV4T2YoJyAnICsgbmFtZSArICcgJykgIT09IC0xO1xufVxuXG5leHBvcnRzLmRlZmF1bHQgPSBoYXNDbGFzcztcbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aGFzLWNsYXNzLmpzLm1hcFxuIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX3RyaW0gPSByZXF1aXJlKCcuLi91dGlsL3RyaW0nKTtcblxudmFyIF90cmltMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3RyaW0pO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG52YXIgd3MgPSAvXFxzKy87IC8qKlxuICAgICAgICAgICAgICAgICAqICMgUmVtb3ZlIENsYXNzXG4gICAgICAgICAgICAgICAgICogUmVtb3ZlIGEgY2xhc3Mgb24gYW4gZWxlbWVudC5cbiAgICAgICAgICAgICAgICAgKlxuICAgICAgICAgICAgICAgICAqIEBwYXJhbSB7RWxlbWVudHxBcnJheX0gZWwgQW4gZWxlbWVudCBvciBhcnJheSBvZiBlbGVtZW50cyB0byB1cGRhdGUuXG4gICAgICAgICAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IG5hbWVcbiAgICAgICAgICAgICAgICAgKiBAcmV0dXJuIHtFbGVtZW50fVxuICAgICAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgICAgICogQG1vZHVsZSBoZWxwZXJzL2RvbS9yZW1vdmUtY2xhc3MuanNcbiAgICAgICAgICAgICAgICAgKi9cblxudmFyIGNsZWFudXAgPSAvXFxzezIsfS9nO1xuXG5mdW5jdGlvbiByZW1vdmVDbGFzcyhlbCwgbmFtZSkge1xuXG4gIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAyICYmIHR5cGVvZiBuYW1lID09PSAnc3RyaW5nJykge1xuICAgIG5hbWUgPSAoMCwgX3RyaW0yLmRlZmF1bHQpKG5hbWUpLnNwbGl0KHdzKTtcbiAgfSBlbHNlIHtcbiAgICBuYW1lID0gbmFtZSBpbnN0YW5jZW9mIEFycmF5ID8gbmFtZSA6IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7XG4gIH1cblxuICAvLyBvcHRpbWl6ZSBmb3IgYmVzdCwgbW9zdCBjb21tb24gY2FzZVxuICBpZiAobmFtZS5sZW5ndGggPT09IDEgJiYgZWwuY2xhc3NMaXN0KSB7XG4gICAgaWYgKG5hbWVbMF0pIGVsLmNsYXNzTGlzdC5yZW1vdmUobmFtZVswXSk7XG4gICAgcmV0dXJuIGVsO1xuICB9XG5cbiAgLy8gc3RvcmUgdHdvIGNvcGllc1xuICB2YXIgY2xzTmFtZSA9ICcgJyArICh0eXBlb2YgZWwuY2xhc3NOYW1lID09PSAnc3RyaW5nJyA/IGVsLmNsYXNzTmFtZSA6IGVsLmdldEF0dHJpYnV0ZSA/IGVsLmdldEF0dHJpYnV0ZSgnY2xhc3MnKSA6ICcnKSArICcgJztcbiAgdmFyIHJlc3VsdCA9IGNsc05hbWU7XG4gIHZhciBjdXJyZW50ID0gdm9pZCAwO1xuICB2YXIgc3RhcnQgPSB2b2lkIDA7XG4gIGZvciAodmFyIGkgPSAwLCBsID0gbmFtZS5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICBjdXJyZW50ID0gbmFtZVtpXTtcbiAgICBzdGFydCA9IGN1cnJlbnQgPyByZXN1bHQuaW5kZXhPZignICcgKyBjdXJyZW50ICsgJyAnKSA6IC0xO1xuICAgIGlmIChzdGFydCAhPT0gLTEpIHtcbiAgICAgIHN0YXJ0ICs9IDE7XG4gICAgICByZXN1bHQgPSByZXN1bHQuc2xpY2UoMCwgc3RhcnQpICsgcmVzdWx0LnNsaWNlKHN0YXJ0ICsgY3VycmVudC5sZW5ndGgpO1xuICAgIH1cbiAgfVxuXG4gIC8vIG9ubHkgd3JpdGUgaWYgbW9kaWZpZWRcbiAgaWYgKGNsc05hbWUgIT09IHJlc3VsdCkge1xuICAgIGlmICh0eXBlb2YgZWwuY2xhc3NOYW1lID09PSAnc3RyaW5nJykge1xuICAgICAgZWwuY2xhc3NOYW1lID0gKDAsIF90cmltMi5kZWZhdWx0KShyZXN1bHQucmVwbGFjZShjbGVhbnVwLCAnICcpKTtcbiAgICB9IGVsc2UgaWYgKGVsLnNldEF0dHJpYnV0ZSkge1xuICAgICAgZWwuc2V0QXR0cmlidXRlKCdjbGFzcycsICgwLCBfdHJpbTIuZGVmYXVsdCkocmVzdWx0LnJlcGxhY2UoY2xlYW51cCwgJyAnKSkpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBlbDtcbn1cblxuZXhwb3J0cy5kZWZhdWx0ID0gcmVtb3ZlQ2xhc3M7XG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXJlbW92ZS1jbGFzcy5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuLyoqXG4gKiAjIERlYm91bmNlXG4gKiBEZWJvdW5jZSBhIGZ1bmN0aW9uIGNhbGxcbiAqXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jXG4gKiBAcGFyYW0ge0ludGVnZXJ9IGRlbGF5XG4gKlxuICogQG1vZHVsZSBoZWxwZXJzL3V0aWwvZGVib3VuY2UuanNcbiAqL1xuZnVuY3Rpb24gZGVib3VuY2UoZnVuYywgZGVsYXkpIHtcblxuICB2YXIgdGltZXIgPSB2b2lkIDA7XG5cbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcbiAgICBpZiAodGltZXIpIHdpbmRvdy5jbGVhclRpbWVvdXQodGltZXIpO1xuICAgIHRpbWVyID0gd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgZnVuYy5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICB9LCBkZWxheSk7XG4gIH07XG59XG5cbmV4cG9ydHMuZGVmYXVsdCA9IGRlYm91bmNlO1xubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzW1wiZGVmYXVsdFwiXTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRlYm91bmNlLmpzLm1hcFxuIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuLyoqXG4gKiAjIEVhY2hcbiAqIEFwcGx5IGEgY2FsbGJhY2sgZnVuY3Rpb24gdG8gYSBsaXN0IG9mIGFueSBraW5kOiBBcnJheSwgTm9kZUxpc3QsIEhUTUxDb2xsZWN0aW9uIG9yIE9iamVjdC5cbiAqXG4gKiBAcGFyYW0ge0FycmF5fE5vZGVMaXN0fEhUTUxDb2xsZWN0aW9ufE9iamVjdH0gbGlzdFxuICogQHBhcmFtIHtGdW5jdGlvbn0gY2JcbiAqXG4gKiBAZXhhbXBsZVxuICogZWFjaChbXSwgY2FsbGJhY2spO1xuICogZWFjaChlbC5jaGlsZHJlbiwgY2FsbGJhY2spO1xuICogZWFjaChlbC5jaGlsZE5vZGVzLCBjYWxsYmFjayk7XG4gKiBlYWNoKHt9LCBjYWxsYmFjayk7XG4gKlxuICogQG1vZHVsZSBoZWxwZXJzL3V0aWwvZWFjaC5qc1xuICovXG5mdW5jdGlvbiBlYWNoKGxpc3QsIGNiKSB7XG5cbiAgaWYgKCFsaXN0KSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKHR5cGVvZiBjYiAhPT0gJ2Z1bmN0aW9uJykge1xuICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IGludm9rZSBgZWFjaGAgd2l0aG91dCBhIGNhbGxiYWNrIScpO1xuICB9XG5cbiAgdmFyIGkgPSAwO1xuICB2YXIgbGVuID0gbGlzdC5sZW5ndGg7XG5cbiAgLy8gT2JqZWN0XG4gIGlmIChsZW4gPT09IHVuZGVmaW5lZCkge1xuICAgIGZvciAoaSBpbiBsaXN0KSB7XG4gICAgICBpZiAoaSAhPT0gJ3Byb3RvdHlwZScgJiYgbGlzdC5oYXNPd25Qcm9wZXJ0eShpKSkge1xuICAgICAgICBjYihpLCBsaXN0W2ldKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgLy8gQXJyYXktbGlrZVxuICBlbHNlIHtcbiAgICAgIGZvciAoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgY2IobGlzdFtpXSk7XG4gICAgICB9XG4gICAgfVxufVxuXG5leHBvcnRzLmRlZmF1bHQgPSBlYWNoO1xubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG4vLyMgc291cmNlTWFwcGluZ1VSTD1lYWNoLmpzLm1hcFxuIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuLyoqXG4gKiAjIFRyaW1cbiAqIFRyaW0gd2hpdGVzcGFjZSBvbiBhIHN0cmluZy5cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gc3RyXG4gKlxuICogQG1vZHVsZSBoZWxwZXJzL3V0aWwvdHJpbS5qc1xuICovXG5cbnZhciB0cmltUkUgPSAvXltcXHNcXHVGRUZGXFx4QTBdK3xbXFxzXFx1RkVGRlxceEEwXSskL2c7XG5cbmZ1bmN0aW9uIHRyaW0oc3RyKSB7XG4gIHJldHVybiBzdHIucmVwbGFjZSh0cmltUkUsICcnKTtcbn1cblxuZXhwb3J0cy5kZWZhdWx0ID0gdHJpbTtcbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dHJpbS5qcy5tYXBcbiJdfQ=="}